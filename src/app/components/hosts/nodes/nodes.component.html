<style>
/* The Modal (background) */
.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
  -webkit-transition: all 0.3s;
  -moz-transition: all 0.3s;
  transition: all 0.3s;
}

/* Modal Content */
.modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
}

/* The Close Button */
.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}
.dropbtn {
  background-color: #4CAF50;
  color: white;
  padding: 16px;
  font-size: 16px;
  border: none;
}

.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;

}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

.dropdown-content a:hover {background-color: #ddd;}

.dropdown:hover .dropdown-content {display: block;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}

.card-title{
  font-size: 1.0rem;
  font-weight: 500;
  color: #646c9a
}

.btn i{
  padding-right:0rem !important;
}

</style>

<div class="kt-grid kt-grid--hor kt-grid--root">
  <div *ngIf="showLoader" class="text-center">
    <span class="spinner-border spinner-border-sm spinner-loader" role="status" aria-hidden="true"></span>
  </div>
  <div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--ver kt-page">
    <div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--hor kt-wrapper" id="kt_wrapper" [ngClass]="hostData ? 'no-padding':'' ">

      <!-- <div class="kt-content kt-grid__item kt-grid__item--fluid"> -->
      <div class="kt-portlet kt-portlet--mobile kt-portlet--responsive-mobile" style="margin-bottom: 0px;">
        <div class="kt-portlet__head kt-portlet__head--lg">
          <div class="kt-portlet__head-toolbar">
            <div class="kt-portlet__head-wrapper">
              <span class="kt-portlet__head-icon">
                <i class="kt-font-brand fa fa-desktop "></i>
              <a href="/hosts" class="" data-toggle="kt-tooltip" title="Back to Nodes">
                <!-- <i class="kt-font-brand fa fa-arrow-circle-left"></i> -->
              </a>
            </span>
              <label class="kt-portlet__head-title">
                {{node_info?.computer_name}} 
              </label>
            </div>
        </div>


        </div>
        <div class="kt-portlet__body full-height" >
          <!-- Begin:: Portlet/tab -->
          <div class="kt-portlet full-height">
           <div class="kt-portlet__body py-2 full-height">
            <div class="row row-tabs">
              <div [ngClass]="!hostData? 'col-lg-11' : 'col-lg-12'">

              <ul class="nav nav-tabs nav-tabs-line nav-tabs-line-success node-tabs" role="tablist">
                <li class="nav-item">
                  <a class="nav-link active" data-toggle="tab" href="#host_details" role="tab">Details</a>
                </li>

                <li class="nav-item">
                  <a class="nav-link" data-toggle="tab" href="#network_information" role="tab">Network Info</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" data-toggle="tab" href="#additional_packs_query_tags" role="tab">Tags
                    </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" data-toggle="tab" href="#status_log" (click)="status_log_tab()" role="tab">Status Log</a>
                </li>
                <ng-container *AppHasRole="role.adminAccess">
                <li class="nav-item" *ngIf="nodes?.platform=='windows'">
                  <a class="nav-link" data-toggle="tab" href="#Manage_Defender"  role="tab">Security Center</a>
                </li>
              </ng-container>
              <ng-container *AppHasRole="role.adminAccess">
                <li  class="nav-item">
                  <a class="nav-link" data-toggle="tab" href="#live_terminal"  role="tab">Live Terminal</a>
                </li>
              </ng-container>
                <li  class="nav-item">
                  <a class="nav-link" data-toggle="tab" href="#recent_activity"  role="tab">Recent Activity</a>
                </li>
              </ul>
             </div>
             <div class="col-lg-1 pr-0">
               <div class="dropdown" style='float:right'>
                  <button *ngIf="!hostData" class="btn btn-small-opaque" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style='width: 90px;padding-top:4px;padding-bottom:4px'>
                    Action
                  </button>
                  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton" style="min-width:90px">
                    <a class="dropdown-item" style="cursor:pointer;padding-top:5px !important;padding-bottom:5px !important" (click)="onselectoption(1)">View Config</a>
                    <ng-container *AppHasRole="role.adminAccess">
                      <a *ngIf="responseenabled == true && endpoint == true" class="dropdown-item" style="cursor:pointer;padding-top:5px !important;padding-bottom:5px !important" (click)="onselectoption(2)">Restart Agent</a>
                      <a *ngIf="hostState == 0" class="dropdown-item" style="cursor:pointer;padding-top:5px !important;padding-bottom:5px !important" (click)="disableHost()">Disable</a>
                      <a *ngIf="hostState == 1" class="dropdown-item" style="cursor:pointer;padding-top:5px !important;padding-bottom:5px !important" (click)="deleteHost(node_info?.computer_name)">Delete</a>
                    </ng-container>
                  </div>
              </div>
             </div>
           </div>
              <div class="tab-content full-height">
                <div class="tab-pane active" id="host_details" role="tabpanel">
                  <!--begin:: Host Details -->
                  <div id="kt_form" class="kt-form form-horizontal" method="POST">
                    <div class="row">
                      <div class="col-md-12">

                        <!-- ROW 1 -->
                          <div class="row info-row">

                            <div class="dropdown col-md-2 col-form-label form--p info-col" >
                              <div class="col-md-2">
                                <i class="fa fa-user host_name fnt-green no-side-mar"  aria-hidden="true"  data-toggle="tooltip" title="Host Name"></i>
                              </div>
                            <div class="col-md-10 col-form-label form--p overflow" >
                              <span>{{node_info?.computer_name}}</span>
                            </div>
                            <div class="dropdown-content" style="width:430px">
                              <a class="sub_menu_wd">Host Name<b>: </b>{{node_info?.computer_name}}</a>
                              <a class="sub_menu_wd">Host Identifier<b>: </b>{{host_identifier }}</a>
                            </div>
                            </div>

                            
                            <div class="col-md-2 col-form-label form--p overflow info-col" data-toggle="tooltip" title="Make & Model" >
                              <div class="col-md-2">
                                <i class="fa fa-laptop hw_mdl fnt-green no-side-mar" aria-hidden="true" data-toggle="tooltip" title="Make & Model"></i>
                              </div>
                              <div class="col-md-10 col-form-label form--p overflow" >
                                <span>{{node_info?.hardware_vendor}}<b>-</b>{{node_info?.hardware_model}}</span>
                              </div>
                              
                            </div>

                          
                            <div class="col-md-2 col-form-label form--p info-col" data-toggle="tooltip" title="CPU Cores">
                              <div class="col-md-2">
                                <i class="fa fa-microchip cpu_cores fnt-green no-side-mar"  aria-hidden="true" data-toggle="tooltip" title="CPU Cores"></i>
                              </div>
                              <div class="col-md-10 col-form-label form--p overflow" >
                                Cpu Cores<b>-</b>{{node_info?.cpu_physical_cores}}
                              </div>
                            </div>

                            <div class="col-md-4 info-col-last info-col ">
                              <div class="col-md-1">
                                <span *ngIf="os_platform == 'windows'" class='logo-color menu-icon' data-toggle="tooltip" title="Operating System">
                                  <img alt='' src='./assets/media/logo/windows.svg' height='19px' width='16px' />
                                </span>
                                <span *ngIf="os_platform == 'darwin'" class='logo-color menu-icon' data-toggle="tooltip" title="Operating System">
                                  <i class='fab fa-apple' style='font-size: 18px; color: #8e8e93;margin-right:8px'></i>
                                </span>
                                <span *ngIf="!['windows','darwin'].includes(os_platform)" class='logo-color menu-icon' data-toggle="tooltip" title="Operating System">
                                  <img alt='' src='./assets/media/logo/Linux1.svg' height='19px' width='16px' />
                                </span>
                              </div>
                              <div class="col-md-11 col-form-label form--p overflow" >
                                {{os_name}} - {{osInfo?.version}}
                              </div>
                            </div>
                          </div>


                        <!-- ROW 2 -->
                          <div class="row info-row">
                          
                          <div class="col-md-2 col-form-label form--p info-col" data-toggle="tooltip" title="Memory">
                            <div class="col-md-2">
                              <i class="fa fa-memory ph_memory fnt-green no-side-mar" aria-hidden="true" data-toggle="tooltip" title="Memory"></i>
                            </div>
                            <div class="col-md-10 col-form-label form--p overflow">
                              {{physical_memory}}
                            </div>
                          </div>

                          
                          <div class="col-md-2 col-form-label form--p info-col" data-toggle="tooltip" title="Last IP Address">
                            <div class="col-md-2">
                              <img alt='' src='./assets/media/IP_Icon.png' height='23px' width='23px' class="last_ip no-mar" data-toggle="tooltip" title="Last IP Address" style="padding: 0px;"/>
                            </div>
                            <div class="col-md-10 col-form-label form--p overflow">
                              {{this.nodes?.last_ip}}
                            </div>
                          </div>

                        
                          <div class="col-md-2 col-form-label form--p info-col" data-toggle="tooltip" title="Response Action Status">
                            <div class="col-md-2">
                              <i class="fa fa-reply-all rs_action fnt-green no-side-mar" aria-hidden="true"  data-toggle="tooltip" title="Response Action Status"></i>
                            </div>
                            <div class="col-md-10 col-form-label form--p overflow">
                              <div *ngIf="responseenabled == undefined" class="spinner-border text-secondary no-mar" role="status">
                                <span class="sr-only">Loading...</span>
                              </div>
                              <p *ngIf="responseenabled == false;" class="no-mar-botom" id="response_endpoint_status">
                                <i class="fa fa-times-circle" style="color:#fd397a"></i>
                              </p>
                              <p *ngIf="responseenabled == true;" class="no-mar-botom" id="response_endpoint_status">
                                <i class="fa fa-check-circle" style="color:#518c24"></i>
                              </p>
                              <p *ngIf="responseenabled == 'Failed'" class="no-mar-botom" id="response_endpoint_status" style="color:#FF0000">
                                Failed to get status
                              </p>
                            </div>
                          </div>


                        
                          <div class="col-md-4 col-form-label form--p info-col" data-toggle="tooltip" title="Serial No.">
                            <div class="col-md-1">
                              <i class="fa fa-align-justify serial fnt-green no-side-mar" aria-hidden="true" data-toggle="tooltip" title="Serial No."></i>
                            </div>
                            <div class="col-md-11 col-form-label form--p overflow">
                              {{node_info?.hardware_serial}}
                            </div>
                          </div>

                          </div>

                         <!-- ROW 3 -->
                          <div class="row info-row">

                            
                            <div class="col-md-2 col-form-label form--p info-col" data-toggle="tooltip" title="Osquery Version">
                              <div class="col-md-2">
                                <img src="https://blog.rapid7.com/content/images/kk-img/2016/05/logo-osquery.png" data-toggle="tooltip" title="Osquery Version" class="qr_version no-mar">
                              </div>
                              <div class="col-md-10 col-form-label form--p overflow" >
                                {{hostDetails['osquery_version']}}
                              </div>
                            </div>

                            <div class="col-md-2 col-form-label form--p info-col" data-toggle="tooltip" title="EclecticIQ Agent Version">
                              <div class="col-md-2">
                                <img src="../assets/media/eiq-img/EclecticIQ-ER-Logo-Favicon.png" data-toggle="tooltip" title="EclecticIQ Agent Version" class="ex_version no-mar">
                              </div>
                              <div class="col-md-10 col-form-label form--p overflow" >
                                {{hostDetails['extension_version']}}
                              </div>
                            </div>

                            <div class="col-md-2 col-form-label form--p info-col" data-toggle="tooltip" title="Agent Enrolled">
                              <div class="col-md-2">
                                <i class="fa fa-calendar enrolled fnt-green"  aria-hidden="true" data-toggle="tooltip" title="Agent Enrolled"></i>
                              </div>
                              <div class="col-md-10 col-form-label form--p overflow" >
                                Enrolled<b>:</b> {{this.enrolled |  date: 'yyyy-MM-dd'}}
                              </div>
                            </div>

                            <div class="col-md-4 dropdown col-form-label form--p info-col" data-toggle="tooltip" title="Last Seen">
                              <div class="col-md-1">
                                <i class="fa fa-clock lastseen fnt-green no-mar"  aria-hidden="true" ></i>
                              </div>
                              <div class="col-md-11 col-form-label form--p overflow" >
                                <p class="no-mar">Last Seen<b>:</b> {{this.lastcheckin}}</p>
                              </div>
                              <div class="dropdown-content lastseen_menu">
                                <a class="sub_menu_wd help" data-toggle="popover" aria-label="Last status from agent">Last Status<b>:</b> {{this.laststatus}}</a>
                                <a class="sub_menu_wd help" data-toggle="popover" aria-label="Last livequery sent to agent">Last Query Read<b> :</b> {{this.lastqueryread}}</a>
                                <a class="sub_menu_wd help" data-toggle="popover" aria-label="Last livequery response received from agent">Last Query Write<b> :</b> {{this.lastquerywrite}}</a>
                                <a class="sub_menu_wd help" data-toggle="popover" aria-label="Last config refresh happened on agent">Last Config<b>:</b> {{this.lastconfig  }}</a>
                                <a class="sub_menu_wd help" data-toggle="popover" aria-label="Last result uploaded by agent">Last Result<b>:</b>  {{this.lastresult}}</a>
                              </div>
                            </div>

                          </div>

                        </div>
                    </div>
                  </div>
                  <!--end:: Host Details -->

                  <div class="kt-portlet mt-4">
                   <!--start chart-->
                   
                   <!-- Normal View if Detail Pane False -->
                   <div class="row ml-3 mt-4" *ngIf="!hostData">

                      <div class="row col-xs-12 col-md-6 col-lg-6 col-xl-6" >

                        <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6 col-sm-6">
                          <!--begin:: AlienVault OTX Alerts -->
                          <div class="otx_counter_val" >
                            <a *ngIf="alienvault.TOTAL>0" [routerLink]="['../',this.id,'alerts']"  [queryParams]="{from:'alienvault'}"  id="div_alienvault">
                            <div class="kt-portlet kt-portlet--border-bottom-success" style="border-bottom: 3px solid rgb(110, 190, 68);">
                                <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-otx" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                  <div class="kt-widget26 text-overlap">
                                    <div class="row">
                                      <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                          <div class="kt-widget26__content align-top-alerts ">
                                            <span  class="kt-widget26__number" id="otx_counter" style="color: #78c351;"></span>
                                              <!-- <ng-template #otx_counter_val> -->
                                              <span id="otx_counter" class="kt-widget26__number" style="color: #78c351;">{{alienvault.TOTAL}}</span>
                                            <!-- </ng-template> -->
                                            <span class="kt-widget26__desc text-overlap-text" style="">AlienVault</span>
                                        </div>
                                      </div>
                                      <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                        <img class="text-overlap-img" src="./assets/media/AlienVaultOTX.png" height="60px" width="60px" style="opacity: 0.5" />
                                      </div>
                                    </div>
                                  </div>
                                  <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                    <!--begin:: AlienVault OTX Severity -->
                                    <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                      <div class="row">
                                          <div class="col">
                                            <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                            <div class="kt-widget15__item">
                                              <span class="kt-widget15__text" style="color: red;">Critical</span>
                                              <span  id="alienvault_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                                  {{alienvault.CRITICAL}}
                                              </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                            <span id="alienvault_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                              {{alienvault.WARNING}}
                                          </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                            <span  id="alienvault_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                              {{alienvault.LOW}}
                                            </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: navy;">Info</span>
                                            <span  id="alienvault_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                {{alienvault.INFO}}
                                            </span>
                                        </div>
                                        <!-- </ng-container> -->
                                        </div>
                                      </div>
                                    </div>
                                    <!--end:: AlienVault OTX Severity -->
                                  </div>
                                </div>
                              </div>
                            </a>
                          </div>
                          <div class="otx_counter_val" >
                            <a *ngIf="alienvault.TOTAL==0"  id="div_alienvault">
                            <div class="kt-portlet kt-portlet--border-bottom-success" style="border-bottom: 3px solid rgb(110, 190, 68);">
                              <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-otx" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                <div class="kt-widget26 text-overlap">
                                    <div class="row">
                                      <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                        <div class="kt-widget26__content align-top-alerts ">
                                            <span  class="kt-widget26__number" id="otx_counter" style="color: #78c351;"></span>
                                            <!-- <ng-template #otx_counter_val> -->
                                            <span id="otx_counter" class="kt-widget26__number" style="color: #78c351;">{{alienvault.TOTAL}}</span>
                                            <!-- </ng-template> -->
                                            <span class="kt-widget26__desc text-overlap-text" style="">AlienVault</span>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                      <img class="text-overlap-img" src="./assets/media/AlienVaultOTX.png" height="60px" width="60px" style="opacity: 0.5" />
                                    </div>
                                  </div>
                                </div>
                                <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                    <!--begin:: AlienVault OTX Severity -->
                                    <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                      <div class="row">
                                        <div class="col">
                                          <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: red;">Critical</span>
                                            <span  id="alienvault_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                                {{alienvault.CRITICAL}}
                                            </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                            <span id="alienvault_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                              {{alienvault.WARNING}}
                                        </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                            <span  id="alienvault_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                              {{alienvault.LOW}}
                                            </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: navy;">Info</span>
                                            <span  id="alienvault_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                              {{alienvault.INFO}}
                                            </span>
                                        </div>
                                      <!-- </ng-container> -->
                                      </div>
                                    </div>
                                  </div>
                                  <!--end:: AlienVault OTX Severity -->
                                  </div>
                              </div>
                            </div>
                            </a>
                          </div>
                          <!--end:: AlienVault OTX Alerts -->
                        </div>

                        <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6 col-sm-6">
                        <!--begin:: IBMxForce Alerts -->
                          <div class="ibm_counter_val" >
                            <a *ngIf="ibmxforce.TOTAL>0" [routerLink]="['../',this.id,'alerts']"  [queryParams]="{from:'ibmxforce'}">
                            <div class="kt-portlet kt-portlet--border-bottom-danger" style="border-bottom: 3px solid rgb(145, 217, 247);">
                                <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-ibm" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                  <div class="kt-widget26 text-overlap">
                                    <div class="row">
                                      <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                          <div class="kt-widget26__content align-top-alerts ">
                                              <!-- <span  class="kt-widget26__number" id="ibm_counter" style="color: #78c351;"></span> -->
                                              <span id="ibm_counter" class="kt-widget26__number" style="color: #91d9f6;">{{ibmxforce.TOTAL}}</span>
                                            <span class="kt-widget26__desc text-overlap-text" style="width:100px">IBM X-Force Alerts</span>
                                        </div>
                                      </div>
                                      <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                        <img class="text-overlap-img" src="./assets/media/IBMxForce.png" height="60px" width="60px" style="opacity: 0.5" />
                                      </div>
                                    </div>
                                  </div>
                                  <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                    <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                      <div class="row">
                                          <div class="col">
                                            <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                            <div class="kt-widget15__item">
                                              <span class="kt-widget15__text" style="color: red;">Critical</span>
                                              <span  id="ibmxforce_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                                  {{ibmxforce.CRITICAL}}
                                              </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                            <span id="ibmxforce_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                              {{ibmxforce.WARNING}}
                                          </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                            <span  id="ibmxforce_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                              {{ibmxforce.LOW}}
                                            </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: navy;">Info</span>
                                            <span  id="ibmxforce_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                {{ibmxforce.INFO}}
                                            </span>
                                        </div>
                                        <!-- </ng-container> -->
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </a>
                          </div>
                          <div class="ibm_counter_val" >
                            <a *ngIf="ibmxforce.TOTAL==0"  id="div_ibmxforce">
                            <div class="kt-portlet kt-portlet--border-bottom-danger" style="border-bottom: 3px solid rgb(145, 217, 247);">
                              <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-ibm" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                <div class="kt-widget26 text-overlap">
                                    <div class="row">
                                      <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                        <div class="kt-widget26__content align-top-alerts ">
                                            <!-- <span  class="kt-widget26__number" id="ibm_counter" style="color: #78c351;"></span> -->
                                            <span id="ibm_counter" class="kt-widget26__number" style="color: #91d9f6;">{{ibmxforce.TOTAL}}</span>
                                            <span class="kt-widget26__desc text-overlap-text" style="width:100px">IBM X-Force Alerts</span>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                      <img class="text-overlap-img" src="./assets/media/IBMxForce.png" height="60px" width="60px" style="opacity: 0.5" />
                                    </div>
                                  </div>
                                </div>
                                <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                    <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                      <div class="row">
                                        <div class="col">
                                          <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: red;">Critical</span>
                                            <span  id="ibmxforce_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                                {{ibmxforce.CRITICAL}}
                                            </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                            <span id="ibmxforce_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                              {{ibmxforce.WARNING}}
                                        </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                            <span  id="ibmxforce_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                              {{ibmxforce.LOW}}
                                            </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: navy;">Info</span>
                                            <span  id="ibmxforce_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                              {{ibmxforce.INFO}}
                                            </span>
                                        </div>
                                      <!-- </ng-container> -->
                                      </div>
                                    </div>
                                  </div>
                                  </div>
                              </div>
                            </div>
                            </a>
                          </div>
                          <!--end::IBMxForce Alerts -->
                        </div>

                        <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6 col-sm-6">
                        <!--begin:: IBMxForce Alerts -->
                          <div class="rule_counter_val" >
                            <a  *ngIf="rule.TOTAL>0" (click)="goToRuleAlerts('HostRule');" id="div_rule">
                            <div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid rgba(229, 87, 86, 0.81);">
                                <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-rule" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                  <div class="kt-widget26 text-overlap">
                                    <div class="row">
                                      <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                          <div class="kt-widget26__content align-top-alerts ">
                                              <!-- <span  class="kt-widget26__number" id="ibm_counter" style="color: #78c351;"></span> -->
                                              <span id="ibm_counter" class="kt-widget26__number" style="color: #e87373">{{rule.TOTAL}}</span>
                                            <span class="kt-widget26__desc text-overlap-text" style="width:100px">Rule Alerts</span>
                                        </div>
                                      </div>
                                      <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                        <img class="text-overlap-img" src="./assets/media/rule_alerts.png" height="60px" width="60px" style="opacity: 0.5" />
                                      </div>
                                    </div>
                                  </div>
                                  <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                    <!--begin:: AlienVault OTX Severity -->
                                    <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                      <div class="row">
                                          <div class="col">
                                            <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                            <div class="kt-widget15__item">
                                              <span class="kt-widget15__text" style="color: red;">Critical</span>
                                              <span  id="rule_counter" class="kt-widget15__stats pull-right" style="color: red;">
                                                  {{rule.CRITICAL}}
                                              </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                            <span id="rule_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                              {{rule.WARNING}}
                                          </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                            <span  id="rule_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                              {{rule.LOW}}
                                            </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: navy;">Info</span>
                                            <span  id="rule_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                {{rule.INFO}}
                                            </span>
                                        </div>
                                        <!-- </ng-container> -->
                                        </div>
                                      </div>
                                    </div>
                                    <!--end:: AlienVault OTX Severity -->
                                  </div>
                                </div>
                              </div>
                            </a>
                          </div>
                          <div class="rule_counter_val" >
                            <a  *ngIf="rule.TOTAL==0" id="div_rule">
                            <div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid rgba(229, 87, 86, 0.81);">
                                <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-rule" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                  <div class="kt-widget26 text-overlap">
                                    <div class="row">
                                      <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                          <div class="kt-widget26__content align-top-alerts ">
                                              <!-- <span  class="kt-widget26__number" id="ibm_counter" style="color: #78c351;"></span> -->
                                              <span id="ibm_counter" class="kt-widget26__number" style="color: #e87373">{{rule.TOTAL}}</span>
                                            <span class="kt-widget26__desc text-overlap-text" style="width:100px">Rule Alerts</span>
                                        </div>
                                      </div>
                                      <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                        <img class="text-overlap-img" src="./assets/media/rule_alerts.png" height="60px" width="60px" style="opacity: 0.5" />
                                      </div>
                                    </div>
                                  </div>
                                  <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                    <!--begin:: AlienVault OTX Severity -->
                                    <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                      <div class="row">
                                          <div class="col">
                                            <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                            <div class="kt-widget15__item">
                                              <span class="kt-widget15__text" style="color: red;">Critical</span>
                                              <span  id="rule_counter" class="kt-widget15__stats pull-right" style="color: red;">
                                                  {{rule.CRITICAL}}
                                              </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                            <span id="rule_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                              {{rule.WARNING}}
                                          </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                            <span  id="rule_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                              {{rule.LOW}}
                                            </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: navy;">Info</span>
                                            <span  id="rule_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                {{rule.INFO}}
                                            </span>
                                        </div>
                                        <!-- </ng-container> -->
                                        </div>
                                      </div>
                                    </div>
                                    <!--end:: AlienVault OTX Severity -->
                                  </div>
                                </div>
                              </div>
                            </a>
                          </div>
                          <!--end:: AlienVault OTX Alerts -->
                        </div>

                        <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6 col-sm-6">
                        <!--begin:: VirusTotal Alerts -->
                          <div class="vt_counter_val" >
                            <a  *ngIf="virustotal.TOTAL>0" [routerLink]="['../',this.id,'alerts']" [queryParams]="{from:'virustotal'}"  id="div_virustotal">
                            <div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid rgb(60, 95, 246);">
                                <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-virus" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                  <div class="kt-widget26 text-overlap">
                                    <div class="row">
                                      <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                          <div class="kt-widget26__content align-top-alerts ">
                                              <span id="vt_counter" class="kt-widget26__number" style="color: #3c5ff6">{{virustotal.TOTAL}}</span>
                                            <span class="kt-widget26__desc text-overlap-text" style="">VirusTotal Alerts</span>
                                        </div>
                                      </div>
                                      <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                        <img class="text-overlap-img" src="./assets/media/VirusTotal.png" height="60px" width="60px" style="opacity: 0.5" />
                                      </div>
                                    </div>
                                  </div>
                                  <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                    <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                      <div class="row">
                                          <div class="col">
                                            <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                            <div class="kt-widget15__item">
                                              <span class="kt-widget15__text" style="color: red;">Critical</span>
                                              <span  id="virustotal_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                                  {{virustotal.CRITICAL}}
                                              </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                            <span id="virustotal_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                              {{virustotal.WARNING}}
                                          </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                            <span  id="virustotal_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                              {{virustotal.LOW}}
                                            </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: navy;">Info</span>
                                            <span  id="virustotal_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                {{virustotal.INFO}}
                                            </span>
                                        </div>
                                        <!-- </ng-container> -->
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </a>
                          </div>
                          <div class="vt_counter_val" >
                            <a  *ngIf="virustotal.TOTAL==0"  id="div_virustotal">
                            <div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid rgb(60, 95, 246);">
                              <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-virus" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                <div class="kt-widget26 text-overlap">
                                    <div class="row">
                                      <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                        <div class="kt-widget26__content align-top-alerts ">
                                            <span id="vt_counter" class="kt-widget26__number" style="color: #3c5ff6">{{virustotal.TOTAL}}</span>
                                            <span class="kt-widget26__desc text-overlap-text" style="">VirusTotal Alerts</span>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                      <img class="text-overlap-img" src="./assets/media/VirusTotal.png" height="60px" width="60px" style="opacity: 0.5" />
                                    </div>
                                  </div>
                                </div>
                                <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                    <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                      <div class="row">
                                        <div class="col">
                                          <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: red;">Critical</span>
                                            <span  id="virustotal_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                                {{virustotal.CRITICAL}}
                                            </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                            <span id="virustotal_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                              {{virustotal.WARNING}}
                                        </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                            <span  id="virustotal_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                              {{virustotal.LOW}}
                                            </span>
                                        </div>
                                        <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: navy;">Info</span>
                                            <span  id="virustotal_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                              {{virustotal.INFO}}
                                            </span>
                                        </div>
                                      <!-- </ng-container> -->
                                      </div>
                                    </div>
                                  </div>
                                  </div>
                              </div>
                            </div>
                            </a>
                          </div>
                          <!--end:: VirusTotal Alerts -->
                        </div>
                        <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6 col-sm-6">
                          <div class="rule_counter_val" >
                            <a  *ngIf="ioc.TOTAL>0" style="cursor: pointer;"  (click)="goToRuleAlerts('HostIOC');" id="div_rule">
                            <div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid rgba(49, 178, 164)">
                                <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid ioc-color-rule" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                  <div class="kt-widget26 text-overlap">
                                    <div class="row">
                                      <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                          <div class="kt-widget26__content align-top-alerts ">
                                              <!-- <span  class="kt-widget26__number" id="ibm_counter" style="color: #78c351;"></span> -->
                                              <span id="ibm_counter" class="kt-widget26__number" style="color: #31b2a4">{{ioc.TOTAL}}</span>
                                            <span class="kt-widget26__desc text-overlap-text" style="width:100px">IOC Alerts</span>
                                        </div>
                                      </div>
                                      <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6 responsive-alert-logo">
                                        <i class="kt-font-brand fa fa-server fa-4x"></i>
                                        <!-- <img class="text-overlap-img" src="./assets/media/rule_alerts.png" height="60px" width="60px" style="opacity: 0.5" /> -->
                                      </div>
                                    </div>
                                  </div>
                                  <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                    <!--begin:: AlienVault OTX Severity -->
                                    <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                      <div class="row">
                                          <div class="col">
                                            <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                            <div class="kt-widget15__item">
                                              <span class="kt-widget15__text" style="color: red;">Critical</span>
                                              <span  id="ioc_counter" class="kt-widget15__stats pull-right" style="color: red;">
                                                  {{ioc.CRITICAL}}
                                              </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                            <span id="ioc_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                              {{ioc.WARNING}}
                                          </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                            <span  id="ioc_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                              {{ioc.LOW}}
                                            </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: navy;">Info</span>
                                            <span  id="ioc_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                {{ioc.INFO}}
                                            </span>
                                        </div>
                                        <!-- </ng-container> -->
                                        </div>
                                      </div>
                                    </div>
                                    <!--end:: AlienVault OTX Severity -->
                                  </div>
                                </div>
                              </div>
                            </a>
                          </div>
                          <div class="rule_counter_val" >
                            <a  *ngIf="ioc.TOTAL==0" style="cursor: pointer;" id="div_rule">
                            <div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid rgba(49, 178, 164);">
                                <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid ioc-color-rule" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                  <div class="kt-widget26 text-overlap">
                                    <div class="row">
                                      <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                          <div class="kt-widget26__content align-top-alerts ">
                                              <!-- <span  class="kt-widget26__number" id="ibm_counter" style="color: #78c351;"></span> -->
                                              <span id="ibm_counter" class="kt-widget26__number" style="color: #31b2a4">{{ioc.TOTAL}}</span>
                                            <span class="kt-widget26__desc text-overlap-text" style="width:100px">IOC Alerts</span>
                                        </div>
                                      </div>
                                      <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6 responsive-alert-logo">
                                        <i class="kt-font-brand fa fa-server fa-4x"></i>
                                        <!-- <img class="text-overlap-img" src="./assets/media/rule_alerts.png" height="60px" width="60px" style="opacity: 0.5" /> -->
                                      </div>
                                    </div>
                                  </div>
                                  <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                    <!--begin:: AlienVault OTX Severity -->
                                    <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                      <div class="row">
                                          <div class="col">
                                            <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                            <div class="kt-widget15__item">
                                              <span class="kt-widget15__text" style="color: red;">Critical</span>
                                              <span  id="ioc_counter" class="kt-widget15__stats pull-right" style="color: red;">
                                                  {{ioc.CRITICAL}}
                                              </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                            <span id="ioc_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                              {{ioc.WARNING}}
                                          </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                            <span  id="ioc_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                              {{ioc.LOW}}
                                            </span>
                                          </div>
                                          <div class="kt-widget15__item">
                                            <span class="kt-widget15__text" style="color: navy;">Info</span>
                                            <span  id="ioc_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                {{ioc.INFO}}
                                            </span>
                                        </div>
                                        <!-- </ng-container> -->
                                        </div>
                                      </div>
                                    </div>
                                    <!--end:: AlienVault OTX Severity -->
                                  </div>
                                </div>
                              </div>
                            </a>
                          </div>
                        </div>
                      </div>

                      <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6">
                        <!--begin::Portlet-->
                        <div class="kt-portlet mb-0">
                          <div class="kt-portlet__head" style="min-height:35px">
                            <div class="kt-portlet__head-label">
                              <span class="kt-portlet__head-icon kt-hidden">
                                <i class="la la-gear"></i>
                              </span>
                              <h4 class="kt-portlet__head-title Kt-lbl-sz">
                                Top Alerting Rules on {{node_info?.computer_name}}
                              </h4>
                            </div>
                          </div>
                          <div id="divchart1">
                            <div id="top_rules" >
                            <canvas id="alerted_rules" class="top_rules" style="height:230px;width:100%"></canvas>
                          </div>
                            <div id="no-data-bar-chart-top_5_alerted_rules" style="margin-left: 50px; margin-top: 40px;"></div>
                          </div>

                        </div>
                        <!--end::Portlet-->
                      </div>

                   </div>

                   <!-- Accordion If Detail Pane True -->
                    <div class="tab-content" id="graph_tree" *ngIf="hostData">
                      <!--begin::Process Analysis-->
                      <div id="accordion" class="accordion" >
                        <div class="" >
                          <!-- <div class="card-header" data-skin="dark" data-toggle="tooltip" data-placement="top" title="Process Analysis">
                            <div class="card-link text_change collapsible2 node" data-toggle="collapse" href="#collapseTwo">
                              Process Analysis
                            </div>
                          </div> -->
                          <div class="card-header collapsed card-header-accordion"  data-toggle="collapse" href="#collapseOne" style="cursor: pointer;">
                            <a class="card-title title-accordion"> Alerting Rules </a>
                          </div>
                    
                          <div id="collapseOne" class="collapse row accordion-data-row" data-parent="#accordion1">
                            <!-- <h4 class=" placeholder_event_Process_analysis" style="margin-left: 3%;margin-top:2%;"> Loading process analysis...<span class=" spinner-border" role="status" style="color: #3498db;" aria-hidden="true"></span></h4>
                            <h3 style="display: none;margin: 10px;" id="process_analysis_hidden_text">Process analysis not applicable </h3> -->
                            <div class="row col-xs-12 col-md-12 col-lg-12 col-xl-6" >

                              <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6 col-sm-6">
                                <!--begin:: AlienVault OTX Alerts -->
                                <div class="otx_counter_val" >
                                  <a *ngIf="alienvault.TOTAL>0" [routerLink]="['../',this.id,'alerts']"  [queryParams]="{from:'alienvault'}"  id="div_alienvault">
                                  <div class="kt-portlet kt-portlet--border-bottom-success" style="border-bottom: 3px solid rgb(110, 190, 68);">
                                      <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-otx" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                        <div class="kt-widget26 text-overlap">
                                          <div class="row">
                                            <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                                <div class="kt-widget26__content align-top-alerts ">
                                                  <span  class="kt-widget26__number" id="otx_counter" style="color: #78c351;"></span>
                                                    <!-- <ng-template #otx_counter_val> -->
                                                    <span id="otx_counter" class="kt-widget26__number" style="color: #78c351;">{{alienvault.TOTAL}}</span>
                                                  <!-- </ng-template> -->
                                                  <span class="kt-widget26__desc text-overlap-text" style="">AlienVault</span>
                                              </div>
                                            </div>
                                            <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6 responsive-alert-logo">
                                              <img class="text-overlap-img" src="./assets/media/AlienVaultOTX.png" height="60px" width="60px" style="opacity: 0.5" />
                                            </div>
                                          </div>
                                        </div>
                                        <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                          <!--begin:: AlienVault OTX Severity -->
                                          <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                            <div class="row">
                                                <div class="col">
                                                  <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                                  <div class="kt-widget15__item">
                                                    <span class="kt-widget15__text" style="color: red;">Critical</span>
                                                    <span  id="alienvault_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                                        {{alienvault.CRITICAL}}
                                                    </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                                  <span id="alienvault_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                                    {{alienvault.WARNING}}
                                                </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                                  <span  id="alienvault_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                                    {{alienvault.LOW}}
                                                  </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: navy;">Info</span>
                                                  <span  id="alienvault_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                      {{alienvault.INFO}}
                                                  </span>
                                              </div>
                                              <!-- </ng-container> -->
                                              </div>
                                            </div>
                                          </div>
                                          <!--end:: AlienVault OTX Severity -->
                                        </div>
                                      </div>
                                    </div>
                                  </a>
                                </div>
                                <div class="otx_counter_val" >
                                  <a *ngIf="alienvault.TOTAL==0"  id="div_alienvault">
                                  <div class="kt-portlet kt-portlet--border-bottom-success" style="border-bottom: 3px solid rgb(110, 190, 68);">
                                    <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-otx" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                      <div class="kt-widget26 text-overlap">
                                          <div class="row">
                                            <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                              <div class="kt-widget26__content align-top-alerts ">
                                                  <span  class="kt-widget26__number" id="otx_counter" style="color: #78c351;"></span>
                                                  <!-- <ng-template #otx_counter_val> -->
                                                  <span id="otx_counter" class="kt-widget26__number" style="color: #78c351;">{{alienvault.TOTAL}}</span>
                                                  <!-- </ng-template> -->
                                                  <span class="kt-widget26__desc text-overlap-text" style="">AlienVault</span>
                                              </div>
                                          </div>
                                          <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6 responsive-alert-logo">
                                            <img class="text-overlap-img" src="./assets/media/AlienVaultOTX.png" height="60px" width="60px" style="opacity: 0.5" />
                                          </div>
                                        </div>
                                      </div>
                                      <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                          <!--begin:: AlienVault OTX Severity -->
                                          <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                            <div class="row">
                                              <div class="col">
                                                <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: red;">Critical</span>
                                                  <span  id="alienvault_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                                      {{alienvault.CRITICAL}}
                                                  </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                                  <span id="alienvault_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                                    {{alienvault.WARNING}}
                                              </span>
                                              </div>
                                              <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                                  <span  id="alienvault_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                                    {{alienvault.LOW}}
                                                  </span>
                                              </div>
                                              <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: navy;">Info</span>
                                                  <span  id="alienvault_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                    {{alienvault.INFO}}
                                                  </span>
                                              </div>
                                            <!-- </ng-container> -->
                                            </div>
                                          </div>
                                        </div>
                                        <!--end:: AlienVault OTX Severity -->
                                        </div>
                                    </div>
                                  </div>
                                  </a>
                                </div>
                                <!--end:: AlienVault OTX Alerts -->
                              </div>
      
                              <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6 col-sm-6">
                              <!--begin:: IBMxForce Alerts -->
                                <div class="ibm_counter_val" >
                                  <a *ngIf="ibmxforce.TOTAL>0" [routerLink]="['../',this.id,'alerts']"  [queryParams]="{from:'ibmxforce'}">
                                  <div class="kt-portlet kt-portlet--border-bottom-danger" style="border-bottom: 3px solid rgb(145, 217, 247);">
                                      <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-ibm" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                        <div class="kt-widget26 text-overlap responsive-kt-widget">
                                          <div class="row">
                                            <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                                <div class="kt-widget26__content align-top-alerts ">
                                                    <!-- <span  class="kt-widget26__number" id="ibm_counter" style="color: #78c351;"></span> -->
                                                    <span id="ibm_counter" class="kt-widget26__number" style="color: #91d9f6;">{{ibmxforce.TOTAL}}</span>
                                                    <span class="kt-widget26__desc text-overlap-text" style="width:100px">IBM X-Force Alerts</span>
                                              </div>
                                            </div>
                                            <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6">
                                              <img class="text-overlap-img" src="./assets/media/IBMxForce.png" height="60px" width="60px" style="opacity: 0.5" />
                                            </div>
                                          </div>
                                        </div>
                                        <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                          <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                            <div class="row">
                                                <div class="col">
                                                  <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                                  <div class="kt-widget15__item">
                                                    <span class="kt-widget15__text" style="color: red;">Critical</span>
                                                    <span  id="ibmxforce_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                                        {{ibmxforce.CRITICAL}}
                                                    </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                                  <span id="ibmxforce_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                                    {{ibmxforce.WARNING}}
                                                </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                                  <span  id="ibmxforce_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                                    {{ibmxforce.LOW}}
                                                  </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: navy;">Info</span>
                                                  <span  id="ibmxforce_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                      {{ibmxforce.INFO}}
                                                  </span>
                                              </div>
                                              <!-- </ng-container> -->
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </a>
                                </div>
                                <div class="ibm_counter_val" >
                                  <a *ngIf="ibmxforce.TOTAL==0"  id="div_ibmxforce">
                                  <div class="kt-portlet kt-portlet--border-bottom-danger" style="border-bottom: 3px solid rgb(145, 217, 247);">
                                    <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-ibm" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                      <div class="kt-widget26 text-overlap responsive-kt-widget">
                                          <div class="row">
                                            <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                              <div class="kt-widget26__content align-top-alerts ">
                                                  <!-- <span  class="kt-widget26__number" id="ibm_counter" style="color: #78c351;"></span> -->
                                                  <span id="ibm_counter" class="kt-widget26__number" style="color: #91d9f6;">{{ibmxforce.TOTAL}}</span>
                                                  <span class="kt-widget26__desc text-overlap-text">IBM X-Force Alerts</span>
                                              </div>
                                          </div>
                                          <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6" style="display: flex; justify-content: center;">
                                            <img class="text-overlap-img" src="./assets/media/IBMxForce.png" height="60px" width="60px" style="opacity: 0.5" />
                                          </div>
                                        </div>
                                      </div>
                                      <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                          <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                            <div class="row">
                                              <div class="col">
                                                <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: red;">Critical</span>
                                                  <span  id="ibmxforce_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                                      {{ibmxforce.CRITICAL}}
                                                  </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                                  <span id="ibmxforce_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                                    {{ibmxforce.WARNING}}
                                              </span>
                                              </div>
                                              <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                                  <span  id="ibmxforce_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                                    {{ibmxforce.LOW}}
                                                  </span>
                                              </div>
                                              <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: navy;">Info</span>
                                                  <span  id="ibmxforce_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                    {{ibmxforce.INFO}}
                                                  </span>
                                              </div>
                                            <!-- </ng-container> -->
                                            </div>
                                          </div>
                                        </div>
                                        </div>
                                    </div>
                                  </div>
                                  </a>
                                </div>
                                <!--end::IBMxForce Alerts -->
                              </div>
      
                              <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6 col-sm-6">
                              <!--begin:: IBMxForce Alerts -->
                                <div class="rule_counter_val" >
                                  <a  *ngIf="rule.TOTAL>0" style="cursor: pointer;" (click)="goToRuleAlerts('HostRule');" id="div_rule">
                                  <div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid rgba(229, 87, 86, 0.81);">
                                      <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-rule" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                        <div class="kt-widget26 text-overlap">
                                          <div class="row">
                                            <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                                <div class="kt-widget26__content align-top-alerts ">
                                                    <!-- <span  class="kt-widget26__number" id="ibm_counter" style="color: #78c351;"></span> -->
                                                    <span id="ibm_counter" class="kt-widget26__number" style="color: #e87373">{{rule.TOTAL}}</span>
                                                  <span class="kt-widget26__desc text-overlap-text">Rule Alerts</span>
                                              </div>
                                            </div>
                                            <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6 responsive-alert-logo">
                                              <img class="text-overlap-img" src="./assets/media/rule_alerts.png" height="60px" width="60px" style="opacity: 0.5" />
                                            </div>
                                          </div>
                                        </div>
                                        <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                          <!--begin:: AlienVault OTX Severity -->
                                          <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                            <div class="row">
                                                <div class="col">
                                                  <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                                  <div class="kt-widget15__item">
                                                    <span class="kt-widget15__text" style="color: red;">Critical</span>
                                                    <span  id="rule_counter" class="kt-widget15__stats pull-right" style="color: red;">
                                                        {{rule.CRITICAL}}
                                                    </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                                  <span id="rule_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                                    {{rule.WARNING}}
                                                </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                                  <span  id="rule_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                                    {{rule.LOW}}
                                                  </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: navy;">Info</span>
                                                  <span  id="rule_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                      {{rule.INFO}}
                                                  </span>
                                              </div>
                                              <!-- </ng-container> -->
                                              </div>
                                            </div>
                                          </div>
                                          <!--end:: AlienVault OTX Severity -->
                                        </div>
                                      </div>
                                    </div>
                                  </a>
                                </div>
                                <div class="rule_counter_val" >
                                  <a  *ngIf="rule.TOTAL==0" style="cursor: pointer;" id="div_rule">
                                  <div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid rgba(229, 87, 86, 0.81);">
                                      <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-rule" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                        <div class="kt-widget26 text-overlap">
                                          <div class="row">
                                            <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                                <div class="kt-widget26__content align-top-alerts ">
                                                    <!-- <span  class="kt-widget26__number" id="ibm_counter" style="color: #78c351;"></span> -->
                                                    <span id="ibm_counter" class="kt-widget26__number" style="color: #e87373">{{rule.TOTAL}}</span>
                                                  <span class="kt-widget26__desc text-overlap-text" style="width:100px">Rule Alerts</span>
                                              </div>
                                            </div>
                                            <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6 responsive-alert-logo">
                                              <img class="text-overlap-img" src="./assets/media/rule_alerts.png" height="60px" width="60px" style="opacity: 0.5" />
                                            </div>
                                          </div>
                                        </div>
                                        <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                          <!--begin:: AlienVault OTX Severity -->
                                          <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                            <div class="row">
                                                <div class="col">
                                                  <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                                  <div class="kt-widget15__item">
                                                    <span class="kt-widget15__text" style="color: red;">Critical</span>
                                                    <span  id="rule_counter" class="kt-widget15__stats pull-right" style="color: red;">
                                                        {{rule.CRITICAL}}
                                                    </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                                  <span id="rule_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                                    {{rule.WARNING}}
                                                </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                                  <span  id="rule_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                                    {{rule.LOW}}
                                                  </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: navy;">Info</span>
                                                  <span  id="rule_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                      {{rule.INFO}}
                                                  </span>
                                              </div>
                                              <!-- </ng-container> -->
                                              </div>
                                            </div>
                                          </div>
                                          <!--end:: AlienVault OTX Severity -->
                                        </div>
                                      </div>
                                    </div>
                                  </a>
                                </div>
                                <!--end:: AlienVault OTX Alerts -->
                              </div>
      
                              <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6 col-sm-6">
                              <!--begin:: VirusTotal Alerts -->
                                <div class="vt_counter_val" >
                                  <a  *ngIf="virustotal.TOTAL>0" [routerLink]="['../',this.id,'alerts']" [queryParams]="{from:'virustotal'}"  id="div_virustotal">
                                  <div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid rgb(60, 95, 246);">
                                      <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-virus" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                        <div class="kt-widget26 text-overlap">
                                          <div class="row">
                                            <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                                <div class="kt-widget26__content align-top-alerts ">
                                                    <span id="vt_counter" class="kt-widget26__number" style="color: #3c5ff6">{{virustotal.TOTAL}}</span>
                                                  <span class="kt-widget26__desc text-overlap-text" style="">VirusTotal Alerts</span>
                                              </div>
                                            </div>
                                            <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6 responsive-alert-logo">
                                              <img class="text-overlap-img" src="./assets/media/VirusTotal.png" height="60px" width="60px" style="opacity: 0.5" />
                                            </div>
                                          </div>
                                        </div>
                                        <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                          <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                            <div class="row">
                                                <div class="col">
                                                  <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                                  <div class="kt-widget15__item">
                                                    <span class="kt-widget15__text" style="color: red;">Critical</span>
                                                    <span  id="virustotal_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                                        {{virustotal.CRITICAL}}
                                                    </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                                  <span id="virustotal_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                                    {{virustotal.WARNING}}
                                                </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                                  <span  id="virustotal_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                                    {{virustotal.LOW}}
                                                  </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: navy;">Info</span>
                                                  <span  id="virustotal_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                      {{virustotal.INFO}}
                                                  </span>
                                              </div>
                                              <!-- </ng-container> -->
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </a>
                                </div>
                                <div class="vt_counter_val" >
                                  <a  *ngIf="virustotal.TOTAL==0"  id="div_virustotal">
                                  <div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid rgb(60, 95, 246);">
                                    <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid alerts-color-virus" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                      <div class="kt-widget26 text-overlap">
                                          <div class="row">
                                            <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                              <div class="kt-widget26__content align-top-alerts ">
                                                  <span id="vt_counter" class="kt-widget26__number" style="color: #3c5ff6">{{virustotal.TOTAL}}</span>
                                                  <span class="kt-widget26__desc text-overlap-text" style="">VirusTotal Alerts</span>
                                              </div>
                                          </div>
                                          <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6 responsive-alert-logo">
                                            <img class="text-overlap-img" src="./assets/media/VirusTotal.png" height="60px" width="60px" style="opacity: 0.5" />
                                          </div>
                                        </div>
                                      </div>
                                      <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                          <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                            <div class="row">
                                              <div class="col">
                                                <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: red;">Critical</span>
                                                  <span  id="virustotal_critical" class="kt-widget15__stats pull-right" style="color: red;">
                                                      {{virustotal.CRITICAL}}
                                                  </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                                  <span id="virustotal_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                                    {{virustotal.WARNING}}
                                              </span>
                                              </div>
                                              <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                                  <span  id="virustotal_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                                    {{virustotal.LOW}}
                                                  </span>
                                              </div>
                                              <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: navy;">Info</span>
                                                  <span  id="virustotal_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                    {{virustotal.INFO}}
                                                  </span>
                                              </div>
                                            <!-- </ng-container> -->
                                            </div>
                                          </div>
                                        </div>
                                        </div>
                                    </div>
                                  </div>
                                  </a>
                                </div>
                                <!--end:: VirusTotal Alerts -->
                              </div>
                              <div class="col-xs-12 col-md-6 col-lg-6 col-xl-6 col-sm-6">
                                <div class="rule_counter_val" >
                                  <a  *ngIf="ioc.TOTAL>0"  style="cursor: pointer;" (click)="goToRuleAlerts('HostIOC');" id="div_rule">
                                  <div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid rgba(49, 178, 164)">
                                      <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid ioc-color-rule" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                        <div class="kt-widget26 text-overlap">
                                          <div class="row">
                                            <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                                <div class="kt-widget26__content align-top-alerts ">
                                                    <!-- <span  class="kt-widget26__number" id="ibm_counter" style="color: #78c351;"></span> -->
                                                    <span id="ibm_counter" class="kt-widget26__number" style="color: #31b2a4">{{ioc.TOTAL}}</span>
                                                  <span class="kt-widget26__desc text-overlap-text" style="width:100px">IOC Alerts</span>
                                              </div>
                                            </div>
                                            <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6 responsive-alert-logo">
                                              <i class="kt-font-brand fa fa-server fa-4x"></i>
                                              <!-- <img class="text-overlap-img" src="./assets/media/rule_alerts.png" height="60px" width="60px" style="opacity: 0.5" /> -->
                                            </div>
                                          </div>
                                        </div>
                                        <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                          <!--begin:: AlienVault OTX Severity -->
                                          <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                            <div class="row">
                                                <div class="col">
                                                  <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                                  <div class="kt-widget15__item">
                                                    <span class="kt-widget15__text" style="color: red;">Critical</span>
                                                    <span  id="ioc_counter" class="kt-widget15__stats pull-right" style="color: red;">
                                                        {{ioc.CRITICAL}}
                                                    </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                                  <span id="ioc_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                                    {{ioc.WARNING}}
                                                </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                                  <span  id="ioc_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                                    {{ioc.LOW}}
                                                  </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: navy;">Info</span>
                                                  <span  id="ioc_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                      {{ioc.INFO}}
                                                  </span>
                                              </div>
                                              <!-- </ng-container> -->
                                              </div>
                                            </div>
                                          </div>
                                          <!--end:: AlienVault OTX Severity -->
                                        </div>
                                      </div>
                                    </div>
                                  </a>
                                </div>
                                <div class="rule_counter_val" >
                                  <a  *ngIf="ioc.TOTAL==0" style="cursor: pointer;" id="div_rule">
                                  <div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid rgba(49, 178, 164);">
                                      <div class="kt-portlet__body kt-portlet__body-alerts kt-portlet__body--fluid body-fluid ioc-color-rule" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                        <div class="kt-widget26 text-overlap">
                                          <div class="row">
                                            <div class="col-md-6 col-xl-8 col-lg-8 col-sm-6 col-6 pl-1">
                                                <div class="kt-widget26__content align-top-alerts ">
                                                    <!-- <span  class="kt-widget26__number" id="ibm_counter" style="color: #78c351;"></span> -->
                                                    <span id="ibm_counter" class="kt-widget26__number" style="color: #31b2a4">{{ioc.TOTAL}}</span>
                                                  <span class="kt-widget26__desc text-overlap-text" style="width:100px">IOC Alerts</span>
                                              </div>
                                            </div>
                                            <div class="col-md-6 col-xl-4 col-lg-4 col-sm-6 col-6 responsive-alert-logo">
                                              <i class="kt-font-brand fa fa-server fa-4x"></i>
                                              <!-- <img class="text-overlap-img" src="./assets/media/rule_alerts.png" height="60px" width="60px" style="opacity: 0.5" /> -->
                                            </div>
                                          </div>
                                        </div>
                                        <div class="table-inner-delete severity-dash" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="">
                                          <!--begin:: AlienVault OTX Severity -->
                                          <div class="kt-widget15__items severity-inner severity-dash-left" style=" height:80px;">
                                            <div class="row">
                                                <div class="col">
                                                  <!-- <ng-container *ngFor="let al of dashboardData.data"> -->
                                                  <div class="kt-widget15__item">
                                                    <span class="kt-widget15__text" style="color: red;">Critical</span>
                                                    <span  id="ioc_counter" class="kt-widget15__stats pull-right" style="color: red;">
                                                        {{ioc.CRITICAL}}
                                                    </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: orange;">Warning</span>
                                                  <span id="ioc_warning" class="kt-widget15__stats pull-right" style="color: orange;">
                                                    {{ioc.WARNING}}
                                                </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: forestgreen;">Low</span>
                                                  <span  id="ioc_low" class="kt-widget15__stats pull-right" style="color: forestgreen;">
                                                    {{ioc.LOW}}
                                                  </span>
                                                </div>
                                                <div class="kt-widget15__item">
                                                  <span class="kt-widget15__text" style="color: navy;">Info</span>
                                                  <span  id="ioc_info" class="kt-widget15__stats pull-right" style="color: navy;">
                                                      {{ioc.INFO}}
                                                  </span>
                                              </div>
                                              <!-- </ng-container> -->
                                              </div>
                                            </div>
                                          </div>
                                          <!--end:: AlienVault OTX Severity -->
                                        </div>
                                      </div>
                                    </div>
                                  </a>
                                </div>
                              </div>
                            </div>
      
                            <div class="col-xs-12 col-md-12 col-lg-12 col-xl-6">
                              <!--begin::Portlet-->
                              <div class="kt-portlet mb-0">
                                <div class="kt-portlet__head" style="min-height:35px">
                                  <div class="kt-portlet__head-label">
                                    <span class="kt-portlet__head-icon kt-hidden">
                                      <i class="la la-gear"></i>
                                    </span>
                                    <h4 class="kt-portlet__head-title Kt-lbl-sz">
                                      Top Alerting Rules on {{node_info?.computer_name}}
                                    </h4>
                                  </div>
                                </div>
                                <div id="divchart1">
                                  <div id="top_rules" >
                                  <canvas id="alerted_rules" class="top_rules" style="height:230px;width:100%"></canvas>
                                </div>
                                  <div id="no-data-bar-chart-top_5_alerted_rules" style="margin-left: 50px; margin-top: 40px;"></div>
                                </div>
      
                              </div>
                              <!--end::Portlet-->
                            </div>

                          </div>
                        </div>
                      </div>
                      <!--end::Process Analysis-->
                    </div>

                   <!--end chart-->
                  </div>
                </div>


                 <!--Begin:: Modal-->
                  <div class="modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" style="display: none;z-index: 10000; position: fixed; background-color: hsla(0, 0%, 0%, 0.45)" >
                    <div class="modal-dialog modal-lg" role="document">
                      <div class="modal-content modal-width"  style=''>
                        <div class="modal-header">
                          <!-- <h3 class="">Alerted Entry</h3> -->
                          <span id="stitle">Configuration</span>
                          <h3 class=""></h3>
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="close()"></button>

                        </div>
                        <div class="modal-body kt-scroll" data-scroll="false" data-height="200" data-scrollbar-shown="true">
                          <!--begin:: Widgets/Tasks -->

                          <form class="kt-form" id="kt_form">
                            <div class="row">
                              <!-- <div class="col-xl-2"></div> -->
                              <div class="col-xl-12">
                                <div class="kt-section kt-section--first">
                                  <div class="kt-section__body">
                                    <div class="row mb-3">
                                      <label class="col-6 col-form-label lbl-wt" >Assigned Config :  {{additional_config_data}}</label>
                                          <div *AppHasRole="role.adminAccess" class="col-6 assignedConfig">
                                          <dropdown label="" label="Config: "  [options]="config_list_dropdownList" [formControl]="configSelectControl"  (change)="onItemSelect_config($event.target.value, $event.target.options[$event.target.selectedIndex].text)" [(ngModel)]="configListSelectedItem"></dropdown>
                                          <ng-container *AppHasRole="role.adminAccess">
                                            <appbutton text="Assign config" btnClass="btn-small btn-long" btnType="submit" (click)="Assign_config()" (click)="closeModal('myModal')" ></appbutton>
                                          </ng-container>
                                          </div>
                                          <!-- <button *AppHasRole="role.adminAccess" type="submit" class="btn btn-primary col-2" (click)="Assign_config()" data-dismiss="modal">Assign config</button> -->
                                          
                                    </div>
                                    <div class="" *ngIf="toggle">
                                      <json-editor   [options]="editorOptions" [data]="alerted_data_json"></json-editor>
                                      </div>
                                    </div>

                                </div>
                                <!-- <div class="kt-separator kt-separator--border-dashed kt-separator--space-lg"></div> -->
                              </div>
                              <div class="col-xl-2"></div>
                            </div>
                          </form>
                          <!--end:: Widgets/Tasks -->
                        </div>
                        <div class="modal-footer align-center">
                          <!-- <button type="button" (click)="close()" class="btn btn-outline-secondary" data-dismiss="modal">Close</button> -->
                          <appbutton text="Close" btnClass="btn-small-opaque" btnType="button" (click)="close()" (click)="closeModal('myModal')"></appbutton>
                        </div>
                      </div>
                    </div>
                  </div>
                <!--End:: Modal-->

                <div class="tab-pane" id="network_information" role="tabpanel">
                  <!--begin:: Network Information -->
                  <div id="kt_form" class="kt-form form-horizontal table-responsive" method="POST">
                    <table class="table table-striped- table-bordered table-hover table-checkable ">
                      <thead>
                        <tr>
                          <th>Mac</th>
                          <th>Mask</th>
                          <th>Address</th>
                          <th>Enabled</th>
                          <th>Description</th>
                          <th>Manufacturer</th>
                          <th>Connection_id</th>
                          <th>Connection_status</th>
                        </tr>
                      </thead>
                      <tbody *ngIf="network_info !=null">
                        <tr *ngFor="let networkdata of network_info">
                          <td> {{networkdata.mac}} </td>
                          <td> {{networkdata.mask}} </td>
                          <td> {{networkdata.address}} </td>
                          <td> {{networkdata.enabled}} </td>
                          <td> {{networkdata.description}} </td>
                          <td> {{networkdata.manufacturer}} </td>
                          <td> {{networkdata.connection_id}} </td>
                          <td> {{networkdata.connection_status}} </td>
                        </tr>
                      </tbody>
                    </table>
                    <div *ngIf="network_info ==null" style="text-align: center;">No results</div>
                  </div>
                  <!--end:: Network Information -->
                </div>
                <div class="tab-pane full-height" id="status_log" role="tabpanel">
                  <!--begin:: Status Log  -->
                  <div class="row">
                    <div class="col-sm-12 status-log-show-control">
                      <input *ngIf="status_log_checkbox == false" class="checkboxClass" (change)="toggleEditable($event)" name="status" type="checkbox" >
                      <input  *ngIf="status_log_checkbox == true" id="status" class="checkboxClass" (change)="toggleEditable($event)" name="status" type="checkbox" checked >&nbsp;<span> Show Status Log</span>
                    </div>
                  </div>
                  <div class="col-md-6 px-0" *ngIf="ShowProgess == true">
                    <label>File Exporting......</label>
                    <div class="progress mb-3">
                         <div class="progress-bar progress-bar-striped bg-success progress-bar-animated" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                  </div>
                  <div  *ngIf="status_log_checkbox == true " id="kt_form" class="kt-form form-horizontal full-height" method="POST" [ngClass]="detailPaneActive ? 'detail-pane-active': 'detail-pane-inactive' ">
                    <table datatable [dtOptions]="StatusdtOptions"
                      class="table table-hover table-checkable response_table row-border hover" id="response_table">

                      <thead>
                        <tr>
                          <th class="pl-2 th-width-15">Line</th>
                          <th class="pl-2 th-width-45">Message</th>
                          <th class="pl-4 th-width-10">Severity</th>
                          <th class="pl-2 th-width-10">File Name</th>
                          <th class="pl-2 th-width-10">Created At</th>
                          <th class="pl-2 th-width-10">Version</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let statuslog of log_data">
                          <td class="pl-2"> {{statuslog.line}} </td>
                          <td class="pl-2 td-wd"> {{statuslog.message}} </td>
                          <td class="pl-4"> {{statuslog.severity}} </td>
                          <td class="pl-2"> {{statuslog.filename}} </td>
                          <td class="pl-2"> {{validDateFormat(statuslog.created)}}</td>
                          <td class="pl-2"> {{statuslog.version}} </td>
                        </tr>
                        <tr role="row" class="text-center" *ngIf="log_data?.length === 0">
                          <td colspan="6">
                            {{errorMessageLogs}}
                          </td>
                        </tr>
                      </tbody>
                    </table>
                    <!--end:: Status Log -->
                  </div>
                  <!--begin:: Additional/packs/query/tags -->

                </div>
                <div class="tab-pane" id="Manage_Defender" role="tabpanel">
                                               <!--begin:: Manage Defender  -->
                                               <div class="show_Manage_Defender">
                                               <div class="col-12 row">
                                                 <div class="col-3 pt-3">
                                                   <h5 style="color:#616C9A" class="mb-3">Security Center</h5>
                                                 </div>
                                                 <!-- <div class="col-9 pb-3">
                                                   <button type="submit" (click)="Currentsetting()" class="btn btn-primary pull-right"><i class="fas"></i>Current Settings</button>
                                                   <button type="submit" (click)="Checkupdate()" class="btn btn-primary pull-right mr-3"><i class="fas"></i>Check Update</button>
                                                 </div> -->
                                               </div>
                                              <div class="kt-portlet">
                                                 <div class="kt-portlet__body">
                                                  <div class="button-right" style="padding-bottom:7px">
                                                    <!-- <button *ngIf="responseenabled == true" type="submit" (click)="defender_status_refresh()" style="width:120px" class="btn btn-success pull-right" title="Defender status refresh" >
                                                      <i class="fa fa-sync-alt"></i>&nbsp;<span>Refresh</span>
                                                    </button>
                                                    <button *ngIf="responseenabled == false || responseenabled == undefined" type="submit" (click)="defender_status_refresh()" style="width:120px" class="btn btn-success pull-right" title="Defender status refresh" disabled >
                                                      <i class="fa fa-sync-alt"></i>&nbsp;
                                                      <span>Refresh</span>
                                                    </button> -->

                                                    <appbutton *ngIf="responseenabled == true" btnType="submit" (click)="defender_status_refresh()" text="Refresh" btnClass="btn-small" icon="fa-sync-alt"></appbutton>
                                                    <appbutton *ngIf="responseenabled == false || responseenabled == undefined" btnType="submit" (click)="defender_status_refresh()" text="Refresh" btnClass="btn-small" icon="fa-sync-alt" [isDisabled]="true"></appbutton>
                                                  </div>
                                                   <table class="table table-bordered table-hover table-checkable mb-4">
                                                     <thead style="background-color: ghostwhite;">
                                                       <tr>
                                                         <th>Product Type</th>
                                                         <th>Product Name</th>
                                                         <th>Status</th>
                                                         <th>Signatures</th>
                                                       </tr>
                                                     </thead>
                                                     <tbody>
                                                       <tr *ngFor="let defender_value of windows_defender_list">
                                                         <td> {{defender_value.producttype}}</td>
                                                         <td> {{defender_value.productname}}</td>
                                                         <td *ngIf="defender_value.productstate == 'On'"><i class="fa fa-circle" style="color: green;"></i>  {{defender_value.productstate}}</td>
                                                         <td *ngIf="defender_value.productstate == 'Off'"><i class="fa fa-circle" style="color: #e60f0db3;"></i> {{defender_value.productstate}}</td>
                                                         <td *ngIf="defender_value.productstate != 'Off' && defender_value.productstate != 'On'">{{defender_value.productstate}}</td>
                                                         <td> {{defender_value.productsignatures}}</td>
                                                       </tr>
                                                     </tbody>
                                                   </table>


                                                  <!-- <div class="row mt-3 pb-3" *ngIf="defenderstatus">
                                                     <div class="col-12">
                                                       <button type="submit" (click)="HostSecurityStatus()" class="btn btn-primary pull-right">View Host Security Status</button>
                                                       <button type="submit" (click)="DefenderPreferences()" class="btn btn-primary pull-right mr-3">Get Defender Preferences</button>
                                                     </div>
                                                  </div> -->

                                                 <div class="card mt-3">
                                                   <div id="accordion" class="accordion" style="margin-bottom: 0.5rem;">
                                                     <div class="">
                                                      <div class="card-header collapsed header-button" id="timeline_collapse" data-toggle="collapse" href="#collapseOne" style="cursor: pointer;height:47px">
                                                        <div class="card-header-title">

                                                         <a class="card-title accordian-title">
                                                           <span>Manage Windows Defender</span>
                                                         </a>
                                                        </div>
                                                         <div class="" [ngClass]="hostData? 'align-row btn-low-pad': '' ">
                                                          <ng-container *ngIf="defenderstatus == false || responseenabled == false">
                                                            <appbutton text="View Host Security Status" btnClass="btn-small pull-right btn-long" btnType="submit" [isDisabled]="true"></appbutton>
                                                            <appbutton text="Get Windows Defender Preferences" btnClass="btn-small pull-right btn-long" btnType="button" [isDisabled]="true"></appbutton>
                                                           </ng-container>
                                                           <ng-container *ngIf="defenderstatus == true && responseenabled ==true">
                                                            <appbutton text="View Host Security Status" btnClass="btn-small pull-right btn-long" btnType="submit" (click)="HostSecurityStatus()"></appbutton>
                                                            <appbutton text="Get Windows Defender Preferences" btnClass="btn-small pull-right btn-long" btnType="button" (click)="DefenderPreferences()"></appbutton>
                                                           </ng-container>
                                                         </div>
                                                         
                                                      </div>

                                                     <div id="collapseOne" class="collapse p-3" data-parent="#accordion" >
                                                         <div class="col-12" *ngIf="defenderstatus == false || responseenabled == false || responseenabled == undefined">
                                                           <div class="p-4">
                                                             <label class="lbl-wt mb-0">Windows Defender Management is not available.</label>
                                                           </div>
                                                         </div>
                                                       <div *ngIf="defenderstatus == true && responseenabled ==true">
                                                         <div class="row my-3">
                                                           <div class="col-3 pt-3">
                                                             <h6 style="color:#518c24" class="mb-3">Update Signatures</h6>
                                                           </div>
                                                           <div class="col-9" style="padding-right:55px">
                                                             <!-- <button type="submit" style="width:120px" (click)="UpdateSignatures()" class="btn btn-success pull-right">Update</button> -->
                                                             <appbutton btnType="submit" (click)="UpdateSignatures()" text="Update" btnClass="btn-small pull-right"></appbutton>
                                                           </div>
                                                         </div>

                                                         <div class="kt-separator kt-separator--border-dashed kt-separator--space-xs mb-3"></div>

                                                         <!-- <div class="row my-3">
                                                           <div class="col-12">
                                                             <div class="col-3 pull-right" style="padding-right:26px">
                                                               <button type="submit" (click)="UpdateSignatures()" class="btn btn-primary pull-right">Update Signature</button>
                                                             </div>
                                                           </div>
                                                         </div> -->

                                                         <!-- <div class="kt-portlet">
                                                            <div class="kt-portlet__body">
                                                               <div class="row">
                                                                 <div class="col-12">
                                                                   <div class="kt-section kt-section--first mb-0">
                                                                     <div class="kt-section__body">
                                                                     <div class="form-group row w-100 mb-3">
                                                                        <div class="col-9">
                                                                          <button type="submit" (click)="UpdateSignatures()" class="btn btn-success pull-right">Update</button>
                                                                        </div>
                                                                     </div>
                                                                     </div>
                                                                   </div>
                                                                 </div>
                                                               </div>

                                                             </div>
                                                         </div> -->


                                                          <h6 style="color:#518c24" class="mb-3">Scan Options</h6>
                                                          <div class="kt-portlet">
                                                             <div class="kt-portlet__body">

                                                                <div class="row">
                                                                  <div class="col-12">
                                                                    <div class="kt-section kt-section--first mb-0">
                                                                      <div class="kt-section__body">
                                                                        <div class="form-group row w-100">
                                                                          <div class="col-10">
                                                                            <!-- <div class="kt-radio-inline">
                                                                            <label class="kt-radio col-4">
                                                                            <input checked="" (change)="onScanChange($event.target.value)" type="radio"   value="Quickscan" name="scan">
                                                                            <label>Quick</label>
                                                                            <span></span>
                                                                            </label>
                                                                            <label class="kt-radio col-4">
                                                                            <input name="scan" (change)="onScanChange($event.target.value)"  type="radio"  value="Fullscan" >
                                                                            <label>Full</label>
                                                                            <span></span>
                                                                            </label>
                                                                            <label class="kt-radio col-3">
                                                                            <input   type="radio"  value="Custom" (change)="onScanChange($event.target.value)" name="scan" >
                                                                            <label>Custom</label>
                                                                            <span></span>
                                                                            </label>
                                                                            </div> -->
                                                                           <div class="row">
                                                                             <label class="col-2 col-form-label lbl-wt" >Scan Types</label>
                                                                             <div class="col-4">
                                                                               <select  class="form-control" style="cursor: pointer;" (change)="onScanChange($event.target.value)" data-toggle="tooltip" data-placement="top" title="full">
                                                                                 <option value="Quickscan" selected="selected">Quick</option>
                                                                                 <option value="Fullscan">Full</option>
                                                                                 <option value="Custom">Custom</option>
                                                                              </select>
                                                                             </div>
                                                                           </div>
                                                                          </div>
                                                                           <div class="col-2">
                                                                             <!-- <button type="submit" style="width:120px" [disabled]="disableScan" (click)="ScanNow()" class="btn btn-success pull-right">Scan Now</button> -->
                                                                             <appbutton text="Scan Now" btnClass="btn-small pull-right" btnType="submit" [isDisabled]="disableScan" (click)="ScanNow()"></appbutton>
                                                                           </div>
                                                                        </div>
                                                                    <!--<div class="kt-separator kt-separator--border-dashed kt-separator--space-xs"></div>
                                                                       <div class="form-group row w-100 mb-3">
                                                                           <label class="col-2 col-form-label" >Quick</label>
                                                                         <div class="col-10">
                                                                           <button type="submit" (click)="ScanNow(1)" class="btn btn-success pull-right"><i class="fas fa-search"></i>Scan Now</button>
                                                                         </div>
                                                                      </div>
                                                                      <div class="kt-separator kt-separator--border-dashed kt-separator--space-xs"></div>
                                                                      <div class="form-group row w-100 mb-3">
                                                                           <label class="col-2 col-form-label" >Full</label>
                                                                         <div class="col-10">
                                                                           <button type="submit" (click)="ScanNow(2)" class="btn btn-success pull-right"><i class="fas fa-search"></i>Scan Now</button>
                                                                         </div>
                                                                      </div>
                                                                      <div class="kt-separator kt-separator--border-dashed kt-separator--space-xs mb-4"></div>
                                                                      <div class="form-group row w-100 mb-3">
                                                                           <label class="col-2 col-form-label" >Custom</label>
                                                                           <div class="col-8">
                                                                             <input type="text" name="customurl" id="customurl" class="form-control" [(ngModel)]='customurl'  />
                                                                             <span class="description_ex">Example: For Windows: C:\Users\PolyLogyx\Downloads\suspicious.exe</span>
                                                                           </div>
                                                                         <div class="col-2 mt-3">
                                                                           <button type="submit" (click)="ScanNow(3)" class="btn btn-success pull-right"><i class="fas fa-search"></i>Scan Now</button>
                                                                         </div>
                                                                      </div> -->
                                                                      <div class="kt-separator kt-separator--border-dashed kt-separator--space-xs my-3" *ngIf="Isscanshow"></div>
                                                                      <div class="col-10 row" *ngIf="Isscanshow">
                                                                        <label class="col-2 col-form-label pl-0 lbl-wt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Custom :</label>
                                                                        <div class="col-10 pl-0">
                                                                          <input type="text" name="customurl" id="customurl" class="form-control" [(ngModel)]='customurl'  />
                                                                          <span class="description_ex">Example: C:\\Users\\PolyLogyx\\Downloads</span>
                                                                        </div>
                                                                      </div>

                                                                      </div>
                                                                    </div>
                                                                  </div>
                                                                </div>

                                                              </div>
                                                          </div>

                                                          <h6 style="color:#518c24" class="mb-3">Scheduled Scan</h6>
                                                          <div class="kt-portlet">
                                                             <div class="kt-portlet__body">

                                                                <div class="row">
                                                                  <div class="col-12">
                                                                    <div class="kt-section kt-section--first mb-0">
                                                                      <div class="kt-section__body">

                                                                        <div class="form-group row w-100 mb-3">
                                                                          <div class="col-10">
                                                                            <!-- <div class="kt-radio-inline">
                                                                            <label class="kt-radio col-4">
                                                                            <input checked="" (change)="onSheduleChange($event.target.value)" type="radio"   value="QuickShedule" name="Shedule">
                                                                            <label>Quick</label>
                                                                            <span></span>
                                                                            </label>
                                                                            <label class="kt-radio col-4">
                                                                            <input name="Shedule" (change)="onSheduleChange($event.target.value)"  type="radio"  value="FullShedule" >
                                                                            <label>Full</label>
                                                                            <span></span>
                                                                            </label>
                                                                            </div> -->
                                                                            <div class="row">
                                                                              <label class="col-2 col-form-label lbl-wt" >Scan Types</label>
                                                                              <div class="col-4">
                                                                                <select  class="form-control" style="cursor: pointer;" (change)="onSheduleChange($event.target.value)" >
                                                                                  <option value="QuickShedule" selected="selected">Quick</option>
                                                                                  <option value="FullShedule">Full</option>
                                                                               </select>
                                                                              </div>
                                                                            </div>
                                                                          </div>
                                                                           <div class="col-2">
                                                                             <!-- <button type="submit" (click)="Schedule_scan()" style="width:120px" class="btn btn-success pull-right">Save</button> -->
                                                                             <appbutton btnType="submit" text="Save" btnClass="btn-small pull-right" (click)="Schedule_scan()"></appbutton>
                                                                           </div>
                                                                        </div>
                                                                        <div class="kt-separator kt-separator--border-dashed kt-separator--space-xs mb-3"></div>
                                                                        <div class="col-10 row" *ngIf="Isquicksheduleshow">
                                                                          <label class="col-2 col-form-label lbl-wt pl-0" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Around  :</label>
                                                                          <div class="pl-0">
                                                                            <div class="ngx-timepicker-field-example">
                                                                                  <ngx-timepicker-field [(ngModel)]='Quicktimepicker'  [format]="24" [buttonAlign]="'left'"></ngx-timepicker-field>
                                                                            </div>
                                                                          </div>
                                                                        </div>

                                                                        <div class="col-12 row" *ngIf="Isfullsheduleshow">
                                                                          <div class="col-12 pl-0">
                                                                            <div class="form-group row w-100 mb-3">
                                                                              <label class="col-2 col-form-label lbl-wt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; when :</label>
                                                                               <div class="col-5 pl-0">
                                                                                 <div class="kt-radio-inline">
                                                                                 <label class="kt-radio">
                                                                                 <input checked="" (change)="onItemChange($event.target.value)" type="radio"   value="0" name="days">
                                                                                 <i class="rad-fnt">Everyday</i>
                                                                                 <span></span>
                                                                                 </label>
                                                                                 <label class="kt-radio">
                                                                                 <input name="days" (change)="onItemChange($event.target.value)"  type="radio"  value="1" >
                                                                                 <i class="rad-fnt">Select Days</i>
                                                                                 <span></span>
                                                                                 </label>
                                                                                 <label class="kt-radio">
                                                                                 <input   type="radio"  value="8" (change)="onItemChange($event.target.value)" name="days" >
                                                                                 <i class="rad-fnt">Never</i>
                                                                                 <span></span>
                                                                                 </label>

                                                                                 </div>
                                                                               </div>
                                                                               <label class="col-2 col-form-label lbl-wt" *ngIf="Isfulltimeshow">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Around :</label>
                                                                               <div class="col-3" *ngIf="Isfulltimeshow">
                                                                                 <div class="ngx-timepicker-field-example">
                                                                                       <ngx-timepicker-field [(ngModel)]='fulltimepicker' [format]="24" [buttonAlign]="'left'"></ngx-timepicker-field>
                                                                                 </div>
                                                                               </div>

                                                                            <div class="card col-8 mt-3" *ngIf="selectdays_shows">
                                                                               <div class="row p-3">
                                                                                 <label class="kt-radio col-3" *ngFor="let item of SelectdaysDataList">
                                                                                 <input   type="radio" checked="{{item.isChecked}}" value="{{item.id}}" (change)="onItemChange($event.target.value)" name="selectdays" >
                                                                                 <i class="rad-fnt">{{item.label}}</i>
                                                                                 <span></span>
                                                                                 </label>
                                                                                 <!-- <div class="form-check col-3" *ngFor="let item of SelectdaysDataList">
                                                                                      <input type="checkbox" class="form-check-input"  [(ngModel)]="item.isChecked">
                                                                                      <label class="form-check-label">{{item.label}}</label>
                                                                                  </div> -->
                                                                               </div>
                                                                             </div>
                                                                           </div>
                                                                         </div>
                                                                       </div>

                                                                      <!-- <div class="form-group row w-100 mb-3">
                                                                           <label class="col-7 col-form-label" >Quick</label>
                                                                         <div class="col-3">
                                                                           <div class="ngx-timepicker-field-example">
                                                                                 <ngx-timepicker-field [(ngModel)]='Quicktimepicker' [buttonAlign]="'left'"></ngx-timepicker-field>
                                                                           </div>
                                                                         </div>
                                                                         <div class="col-2">
                                                                           <button type="submit" (click)="Schedule_scan(1)" class="btn btn-success pull-right"><i class="fas"></i>Save</button>
                                                                         </div>
                                                                      </div>
                                                                      <div class="kt-separator kt-separator--border-dashed kt-separator--space-xs"></div>
                                                                      <div class="form-group row w-100 mb-3">
                                                                           <label class="col-2 col-form-label" >Full</label>
                                                                         <div class="col-5">
                                                                           <div class="kt-radio-inline">
                                                                           <label class="kt-radio">
                                                                           <input checked="" (change)="onItemChange($event.target.value)" type="radio"   value="Everyday" name="days">
                                                                           <label>Everyday</label>
                                                                           <span></span>
                                                                           </label>
                                                                           <label class="kt-radio">
                                                                           <input name="days" (change)="onItemChange($event.target.value)"  type="radio"  value="SelectDays" >
                                                                           <label>Select Days</label>
                                                                           <span></span>
                                                                           </label>
                                                                           <label class="kt-radio">
                                                                           <input   type="radio"  value="Never" (change)="onItemChange($event.target.value)" name="days" >
                                                                           <label>Never</label>
                                                                           <span></span>
                                                                           </label>

                                                                           </div>
                                                                         </div>
                                                                         <div class="col-3 mt-2">
                                                                           <div class="ngx-timepicker-field-example">
                                                                                 <ngx-timepicker-field [(ngModel)]='fulltimepicker' [buttonAlign]="'left'"></ngx-timepicker-field>
                                                                           </div>
                                                                         </div>
                                                                         <div class="col-2 mt-3">
                                                                           <button type="submit" (click)="Schedule_scan(2)" class="btn btn-success pull-right"><i class="fas"></i>Save</button>
                                                                         </div>
                                                                         <div class="col-2">
                                                                          </div>
                                                                         <div class="col-5 row" style="padding-left:22px" *ngIf="selectdays_shows">
                                                                           <div class="form-check col-3" *ngFor="let item of SelectdaysDataList">
                                                                                <input type="checkbox" class="form-check-input"  [(ngModel)]="item.isChecked">
                                                                                <label class="form-check-label">{{item.label}}</label>
                                                                            </div>
                                                                         </div>
                                                                      </div> -->
                                                                      </div>
                                                                    </div>
                                                                  </div>
                                                                </div>

                                                              </div>
                                                          </div>

                                                          <h6 style="color:#518c24" class="mb-3">Exclusions</h6>
                                                          <div class="kt-portlet">
                                                             <div class="kt-portlet__body">

                                                                <div class="row">
                                                                  <div class="col-12">
                                                                    <div class="kt-section kt-section--first mb-0">
                                                                      <div class="kt-section__body">
                                                                      <div class="form-group row w-100 mb-3">
                                                                           <label class="col-2 col-form-label lbl-wt" >Files & Locations</label>
                                                                         <div class="col-8">
                                                                           <input type="text" name="Filepath" id="Filepath" [(ngModel)]='Filepath' class="form-control"  />
                                                                           <span class="description_ex">Example: C:\\Users\\PolyLogyx\\Downloads</span>
                                                                         </div>
                                                                         <div class="col-2">
                                                                           <button type="submit" (click)="Exclusions()" data-toggle="tooltip" data-placement="top" title="Add" class="btn btn-success"><i class="fa fa-plus" aria-hidden="true"></i></button>
                                                                           <button type="submit" (click)="Removexclusions()" data-toggle="tooltip" data-placement="top" title="Remove" style="backgroundColor:red" class="btn btn-danger pull-right"><i class="fa fa-minus" aria-hidden="true"></i></button>
                                                                         </div>
                                                                      </div>
                                                                      <div class="kt-separator kt-separator--border-dashed kt-separator--space-xs mb-4"></div>
                                                                      <div class="form-group row w-100 mb-3">
                                                                           <label class="col-2 col-form-label lbl-wt">File Types</label>
                                                                         <div class="col-8">
                                                                           <input type="text" name="FileExtensions" id="FileExtensions" [(ngModel)]='FileExtensions' class="form-control" />
                                                                           <span class="description_ex">Example : .txt,.exe,.pdb</span>
                                                                         </div>
                                                                         <div class="col-2">
                                                                           <button type="submit" (click)="Exclusions()" data-toggle="tooltip" data-placement="top" title="Add" class="btn btn-small"><i class="fa fa-plus" aria-hidden="true"></i></button>
                                                                           <button type="submit" (click)="Removexclusions()" data-toggle="tooltip" data-placement="top" title="Remove" style="backgroundColor:red" class="btn btn-danger pull-right"><i class="fa fa-minus" aria-hidden="true"></i></button>
                                                                         </div>
                                                                      </div>
                                                                      <div class="kt-separator kt-separator--border-dashed kt-separator--space-xs mb-4"></div>
                                                                      <div class="form-group row w-100 mb-3">
                                                                           <label class="col-2 col-form-label lbl-wt">Processes</label>
                                                                           <div class="col-8">
                                                                              <input type="text" name="ProcessName" id="ProcessName" [(ngModel)]='ProcessName' class="form-control"  />
                                                                              <span class="description_ex">Example : C:\\Users\\PolyLogyx\\Downloads\\suspicious.exe</span>
                                                                           </div>
                                                                           <div class="col-2">
                                                                             <button type="submit" (click)="Exclusions()" data-toggle="tooltip" data-placement="top" title="Add" class="btn btn-small"><i class="fa fa-plus" aria-hidden="true"></i></button>
                                                                             <button type="submit" (click)="Removexclusions()" data-toggle="tooltip" data-placement="top" title="Remove" style="backgroundColor:red" class="btn btn-danger pull-right"><i class="fa fa-minus" aria-hidden="true"></i></button>
                                                                           </div>
                                                                      </div>
                                                                      </div>
                                                                    </div>
                                                                  </div>
                                                                </div>

                                                              </div>
                                                          </div>

                                                       </div>
                                                     </div>
                                                    </div>
                                                   </div>

                                                   <div id="accordion1" class="accordion" style="margin-bottom: 0.5rem;">
                                                     <div class="">
                                                       <div class="card-header collapsed" id="timeline_collapse" data-toggle="collapse" href="#collapsetwo"   style="cursor: pointer;height:47px">
                                                         <a class="card-title accordian-title"> Windows Defender Action Center </a>
                                                       </div>
                                                       <div id="collapsetwo" class="collapse p-3" data-parent="#accordion">
                                                        <div class="col-12" *ngIf="defenderstatus == false || responseenabled == false || responseenabled == undefined">
                                                          <div class="p-4">
                                                            <label class="lbl-wt mb-0">Windows Defender Management is not available.</label>
                                                          </div>
                                                        </div>
                                                        <div *ngIf="defenderstatus == true && responseenabled ==true" class="form-group row">
                                                          <label style="color:#518c24" class="col-4 col-form-label" >Quarantined Threats</label>
                                                        <div class="col-8">
                                                          <!-- <button type="submit" (click)="Getquarantine(host_identifier)" class="btn btn-success pull-right" style="width:180px" title="Refresh Quarantined Threats">
                                                            <span>Get Quarantine Threats</span>
                                                          </button> -->
                                                          <appbutton text="Get Quarantine Threats" btnClass="btn-small pull-right btn-long" btnType="submit" (click)="Getquarantine(host_identifier)"></appbutton>
                                                          
                                                        </div>
                                                     </div>
                                                         <div *ngIf="defenderstatus == true && responseenabled ==true" class="kt-portlet">
                                                            <div class="kt-portlet__body" *ngIf="GetQuarantineDiv">
                                                              <h4 class="quarantine_loader" style="margin-left: 3%;margin-top:2%;display:none"> Loading data...<span class=" spinner-border" role="status" style="color: #3498db;" aria-hidden="true"></span></h4>
                                                              <table class="table table-bordered table-hover table-checkable mb-4 Quarantine_Threats" style="display: none;width80%">
                                                                <thead style="background-color: ghostwhite;">
                                                                  <tr>
                                                                    <th style="width:80%">Path</th>
                                                                    <th class="text-center">Action</th>
                                                                  </tr>
                                                                </thead>
                                                                <tbody>
                                                                  <tr *ngFor="let data of QuarantineThreatList">
                                                                    <td style="word-break: break-all;"> {{data.path}}</td>
                                                                    <td class="text-center" style="width:60px"> <button [disabled]='data.disabled'  class="btn btn-small" (click)="Carve_QuarantineThreat(data)" style="padding:5px">Carve</button></td>
                                                                  </tr>
                                                                </tbody>
                                                              </table>
                                                              <!-- <div id="Quarantine_Threats_no_data" style="font-size: larger;font-weight: 600;">Host has not yet responded to the response action.
                                                              </div> -->
                                                              <div *ngIf="empty_data" style="font-size: larger;font-weight: 600;">No Data Found
                                                              </div>
                                                              </div>
                                                         </div>
                                                        </div>
                                                     </div>
                                                   </div>

                                                   <div id="accordion3" class="accordion">
                                                     <div class="">
                                                       <div class="card-header collapsed" id="timeline_collapse" data-toggle="collapse" href="#collapsethree" style="cursor: pointer;height:47px">
                                                         <a class="card-title accordian-title"> Windows Defender Log </a>
                                                       </div>
                                                       <div id="collapsethree" class="collapse p-3" data-parent="#accordion">
                                                         <!-- <h6 style="color:#518c24" class="my-4">Get Quarantine List</h6> -->
                                                         <div class="kt-portlet">
                                                            <div class="kt-portlet__body">
                                                               <div class="">
                                                                 <div class="col-12">
                                                                  <div class="pull-right" style="width:350px">
                                                                    <angular2-multiselect [data]="Malware_Events_dropdownList" [(ngModel)]="Malware_Events_selectedItems"
                                                                    [settings]="Malware_Events_dropdownSettings"
                                                                    (onSelect)="onItemSelect($event)"
                                                                    (onDeSelect)="OnItemDeSelect($event)"
                                                                    (onSelectAll)="onSelectAll($event)"
                                                                    (onDeSelectAll)="onDeSelectAll($event)"></angular2-multiselect>
                                                                  </div>
                                                                   <div class="kt-section kt-section--first mb-0">
                                                                     <!-- <div class="kt-section__body"> -->
                                                                     <div class="form-group row w-100">
                                                                        <!-- <label style="color:#518c24" class="col-4 col-form-label" >Defender Log</label> -->
                                                                        <!-- <div class="col-8">
                                                                          <button  (click)="Getdefenderlog()" class="btn btn-success pull-right">Get Defender Log</button>
                                                                        </div> -->
                                                                     </div>

                                                                     <table datatable [dtOptions]="DefenderdtOptions" [dtTrigger]="DefenderdtTrigger"  class="table table-bordered table-hover table-checkable ">
                                                                          <thead>
                                                                              <tr>
                                                                                <th>Windows Defender Log</th>
                                                                              </tr>
                                                                          </thead>
                                                                          <tbody>
                                                                              <tr *ngFor="let defender_value of defenderloglist" style="font-size: 13px; font-family:Roboto; font-weight: 600;word-break: break-word">
                                                                                <!-- <div (click)="ele.class = ele.class == 'showChildren' ? '' : 'showChildren'" [ngClass]="{ hideChildren : ele.class !== 'showChildren' }" #ele > -->
                                                                                <td class="cell-breakWord">
                                                                                  <div (click)="ele.class = ele.class == 'showChildren' ? '' : 'showChildren'" [ngClass]="{ hideChildren : ele.class !== 'showChildren' }" #ele >
                                                                                    <font color='#16ace3'>
                                                                                       <div >
                                                                                         <div class="sql hljs desc-background_rules container" [class.show_1]="defender_value.visible_1" style="cursor: pointer;">
                                                                                            {{myjson.stringify(defender_value.columns)}}
                                                                                          </div>
                                                                                          <!-- <span *ngIf="myjson.stringify(defender_value.columns).length > 300" style="cursor: pointer;padding-left:10px" class="kt-link" (click)="defender_value.visible_1 = !defender_value.visible_1">{{ defender_value.visible_1 ? 'Read less': 'Read More' }}</span> -->
                                                                                       </div>
                                                                                    </font>
                                                                                    <div (click)="action($event);false" >
                                                                                      <div class="col-10"></div>
                                                                                      <th >
                                                                                         <dt *ngFor="let subhostdata of defender_value.columns | keyvalue">
                                                                                           <dl  style="word-break: break-word;padding-left: 40px;" >
                                                                                              {{subhostdata.key}}
                                                                                              {{":"}}
                                                                                              {{subhostdata.value}}
                                                                                         </dl>
                                                                                       </dt>
                                                                                    </th>
                                                                                   </div>
                                                                                  </div>
                                                                                </td>
                                                                                <!-- </div> -->
                                                                             </tr>
                                                                          </tbody>
                                                                      </table>
                                                                      <div class="text-center" *ngIf="defenderloglist?.length == 0">
                                                                        <span  >
                                                                         {{this.errorMessage}}
                                                                        </span>
                                                                      </div>
                                                                   </div>
                                                                 </div>
                                                               </div>

                                                             </div>
                                                         </div>
                                                        </div>
                                                     </div>
                                                   </div>
                                                </div>
                                               </div>
                                              </div>
                                            </div>
                                              <div class="show_NotApplicable_Msg mb-3"></div>
                </div>


                <div class="modal" id="successModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" style="display: none;z-index: 910; position: fixed; background-color: hsla(0, 0%, 0%, 0.45)">
                 <div class="modal-dialog modal-lg" role="document">
                   <div class="modal-content px-3" style='margin-top: -95px;'>
                     <div class="modal-header">
                        <h5>{{modaltitle}}</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="closedefender()"></button>
                     </div>
                     <div class="modal-body kt-scroll" data-scroll="true" data-height="200" data-scrollbar-shown="true">

                       <form class="kt-form">
                         <div class="row">
                           <pre id ="view_data" class="px-3" style="word-wrap: break-word; white-space: pre-wrap;color:black;background-color:white">{{successdata}}</pre>
                        </div>
                       </form>
                     </div>
                     <div class="modal-footer align-center">
                       <button type="button" class="btn btn-outline-secondary" (click)="closedefender()" data-dismiss="modal">Close</button>
                     </div>
                  </div>
                 </div>
                </div>

                <div class="modal" id="currentsettingModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" style="display: none;z-index: 900; position: fixed; background-color: hsla(0, 0%, 0%, 0.45)" >
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content"  style='margin-top: -95px;width: 800px;'>
                      <div class="modal-header">

                        <span id="stitle">Windows Defender Preferences</span>
                        <h3 class=""></h3>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="closesetting()"></button>

                      </div>
                      <div class="modal-body kt-scroll" data-scroll="false" data-height="200" data-scrollbar-shown="true">
                        <div *ngIf="Isloading" class="mb-4">
                           <!-- <span class="spinner-border spinner-border-md" role="status" aria-hidden="true"></span> -->
                            Fetching data. Please wait...
                           <div class="progress mt-3">
                              <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 100%"></div>
                          </div>
                        </div>
                        <div class="col-12 row pb-3" *ngIf="Isloading == false">

                            <button type="submit" (click)="Refreshsetting()" class="btn btn-small pull-right"><i class="fas"></i>Refresh</button>

                        </div>
                        <table class="table table-striped- table-bordered table-hover table-checkable " >
                          <thead style="background-color: ghostwhite;">
                            <tr>
                              <th>Host</th>
                              <th>Message</th>
                              <th>Status</th>
                              <th>Created Date</th>
                              <th>Update Date</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let item of viewcurrentarray">
                              <td> {{item.hostname}}</td>
                              <td> {{item.message}} </td>
                              <td *ngIf="item.status == 'success'" style="color: green;">{{item.status}}</td>
                              <td *ngIf="item.status == 'pending'" style="color: orange;">{{item.status}}</td>
                              <!-- <td> {{item.status}} </td> -->
                              <td> {{item.created_at}} </td>
                              <td> {{item.updated_at}} </td>
                            </tr>
                          </tbody>
                          <tfoot>
                            {{emptmsg}}
                          </tfoot>
                        </table>
                      </div>
                      <div class="modal-footer align-center">
                        <button type="button" (click)="cancelsetting()" *ngIf="Isloading" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>
                          <button type="button" (click)="closesetting()" *ngIf="Isloading == false" class="btn btn-outline-secondary" data-dismiss="modal">Close</button>
                      </div>
                    </div>
                  </div>
                </div>
                <!--End:: Modal-->

                <div class="modal" id="PendingModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" style="display: none;z-index: 10000; position: fixed; background-color: hsla(0, 0%, 0%, 0.45)" >
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content py-2"  style='width: 450px;'>

                      <div class="modal-body kt-scroll" data-scroll="false" data-height="200" data-scrollbar-shown="true">
                        <!-- <h4>Fetching data. Please wait...</h4> -->
                        <h4>{{loadermsg}}</h4>
                       <div class="progress mt-3">
                          <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 100%"></div>
                      </div>

                      </div>
                      <div class="modal-footer align-center pt-2 pb-1">
                        <button type="button" (click)="closeloader()" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>
                      </div>
                    </div>
                  </div>
                </div>
                <!--End:: Modal-->
                <!--start :: Live terminal-->
                <div class="tab-pane" id="live_terminal" role="tabpanel">
                  <div *ngIf="responseenabled == true && !this.compareAgentVersion">
                    <form class="form form-horizontal" id="cus_respose_form" [formGroup]="scriptform" (ngSubmit)="onscriptSubmit()" enctype="multipart/form-data">
                      <div class="form-group row ">
                        <div class="col-md-1 required">
                            <label class=" col-form-label " for="script_type">Script Type</label>
                        </div>
                        <div class="col-5" *ngIf="nodes?.platform=='windows'">
                          <div class="kt-radio-inline">
                            <label class="kt-radio">
                            <input id="script_type-3" type="radio"  value="2" [(ngModel)]="script_type_value" name="script_type" formControlName="script_type" (change)="get_script_type('PowerShell Script')">
                            <label for="script_type-3">Powershell</label>&nbsp;
                            <img alt='' src='./assets/media/logo/windows.svg' height='19px' width='16px' />
                            <span></span>
                            </label>
                            <label class="kt-radio">
                              <input checked="" id="script_type-0"  type="radio" value="1" [(ngModel)]="script_type_value" name="script_type" formControlName="script_type" (change)="get_script_type('Batch Script')">
                              <label for="script_type-0">Batch</label>&nbsp;
                              <img alt='' src='./assets/media/logo/windows.svg' height='19px' width='16px' />
                            <span></span>
                              </label>
                          </div>
                        </div>
                        <div class="col-5" *ngIf="!['windows'].includes(nodes?.platform)">
                          <div class="kt-radio-inline">
                              <label class="kt-radio">
                                <input checked="" id="script_type-2"  type="radio" value="4" [(ngModel)]="script_type_value" name="script_type" formControlName="script_type" (change)="get_script_type('Shell Script')">
                                <label for="script_type-2">Shell Script</label>&nbsp;
                                <img *ngIf="nodes?.platform=='ubuntu'" alt='' src='./assets/media/logo/Linux1.svg' height='19px' width='16px' />
                                <i *ngIf="nodes?.platform=='darwin'" class="fab fa-2x fa-apple" style="line-height:0px;font-size:1.5em!important;color: #8e8e93;"></i>
                                <span></span>
                                </label>
                          </div>
                        </div>
                      </div>
                        <div class="form-group required row">
                          <label class="col-md-1 col-form-label" for="content">Content</label>
                          <div class="col-lg-8 col-md-12">
                          <label class="">{{script_type_name}} </label>
                          <div ace-editor
                          [(text)]="text"
                          [mode]="'sql'"
                          [theme]="'eclipse'"
                          [options]="options"
                          [readOnly]="false"
                          [autoUpdateContent]="true"
                          (textChanged)="onChange($event)"
                          style="min-height: 150px; width:100%; overflow: auto;	border: 1px solid lightgray"></div>
                          </div>
                          <label class="col-form-label"></label>
                          <p class="col-lg-1 col-md-12 col-or"  >(OR)</p>
                          <div class="col-lg-2 mt-3 col-md-12 col-btn">
                            <div >
                              <label for="file_content" style="" class="btn btn-small btn-long upload-btn">Upload a File</label>
                                <input  type="file" class="custom-input-file"  formControlName="file_content" (change)="uploadFile($event)"  name="file_content" id="file_content" style="display:none">
                              
                              </div>
                              <div *ngIf="file_name"  class="" style="word-break: break-all;">{{file_name}}<i style="margin-left:2%;font-size:12px;color: #FA0303;cursor: pointer;" (click) ="resetFile()" class="fa fa fa-trash-alt"></i></div>
                          </div>
                        </div>
                        <div id="" class="form-group row">
                          <label class="col-md-1 col-form-label" for="custom_script">Params</label>
                          <div class="col-8">
                              <input class="form-control" formControlName="params" id="params" name="params" type="text" value="">
                          </div>
                        </div>
                          <div class="kt-portlet__foot text-center">
                            <!-- <button type="submit" class="btn btn-success" [disabled]="submit_button_disable_enable">
                              <span>Submit</span>
                            </button> -->

                            <appbutton text="Submit" btnClass="btn-small" btnType="submit" [isDisabled]="submit_button_disable_enable"></appbutton>
                            <button type="button"  *ngIf="cancel_live_terminal_request && nodes?.platform=='windows'; else elseif_disable" (click)="Cancel_Live_terminal_Request(Live_terminal_command_id)"  class="btn btn-danger ml-1">Cancel</button>
                            <ng-template #elseif_disable>
                            <!-- <button type="button" *ngIf="nodes?.platform=='windows'" disabled class="btn btn-danger ml-1" title="disabled">Cancel</button> -->
                            <appbutton *ngIf="nodes?.platform=='windows'" text="Cancel" btnClass="btn-small-opaque" btnType="button" [isDisabled]="submit_button_disable_enable" [isDisabled]="true"></appbutton>
                            </ng-template>
                          </div>
                  </form>
                  <div *ngIf="show_live_terminal_results" >
                    <h4 class="lbl-wt" >{{msg_executing_or_executed}}</h4>
                      <div class="kt-portlet">
                          <div class="kt-portlet__body">
                              <h4 class="liveterminal_response_loader" style="margin-left: 3%;margin-top:2%;">{{Loader_msg_based_on_time}}<span *ngIf="spinner"class=" spinner-border" role="status" style="color: #3498db;" aria-hidden="true"></span><a *ngIf="!spinner" [routerLink]="['/response-action/view',openc2_id]" class="">Response Action</a></h4>
                              <div class=" liveterminal_response_data" style="display: none;">

                                    <label class="lbl-wt">Output  </label>
                                    <div class="row col-12" style=" color:white;background-color:black;height:500px;overflow: auto;">
                                          <pre class="liveterminal" >{{liveterminal_response}}</pre>
                                    </div>
                                </div>
                            </div>
                          </div>
                    </div>
                  </div>
                  <div *ngIf="responseenabled ==false && !compareAgentVersion">Terminal is currently not available. Please check the Response Action status.</div>
                  <div *ngIf="compareAgentVersion">Live Terminal feature is applicable from 3.0 release, Please upgrade the agent.</div>
                </div>
                <!--End :: Live terminal-->
                <div class="tab-pane" id="additional_packs_query_tags" role="tabpanel">
                    <!--Begin:: Tags -->
                    <div class="kt-portlet">
                      <div class="kt-portlet__body">

                        <h2 style="color:#616C9A">Tags</h2>
                        <div *AppHasRole="role.adminAccess" >
                          <tag-input [theme]="'foundation-theme'" [placeholder]="'Add tags here...'" [(ngModel)]='tags'
                            (onAdd)="hosts_addTag(tags,id)" (onRemove)="hosts_removeTag($event,id)"
                            [modelAsStrings]="true"></tag-input>
                        </div>
                        <div *AppHasRole="role.userAccess">
                          <input type="text" [placeholder]="'Existings tags...'" value='{{tags}}' readonly>
                        </div>
                      </div>
                    </div>
                    <!--End:: Tags -->
                  <!--begin:: Packs -->
                  <div class="kt-portlet">
                    <div class="kt-portlet__body">
                      <h2 style="color:#616C9A">Associated Packs</h2>
                      <!--Begin:: Content/Packs -->
                      <div *ngIf="packs_count != 0" class="row">
                        <div class="col-md-4">
                          <!--begin::Portlet-->
                          <div class="kt-portlet no-mar-botom portlet-body_align__table">
                            <div class="kt-portlet__body" style="padding: 0px;">
                              <!--begin: Search Table -->
                              <div class="">
                                <div class="kt-input-icon kt-input-icon--left" style="margin-bottom: 10px;">
                                  <input type="text" class="form-control" placeholder="Search Packs here..."
                                     [(ngModel)]="term">
                                  <span class="kt-input-icon__icon kt-input-icon__icon--left">
                                    <span><i class="la la-search"></i></span>
                                  </span>
                                </div>
                              </div>
                              <!--end: Search Table -->
                              <div class="" style="height: 600px; overflow-x: scroll;margin-bottom:25px;">

                                <div class="">
                                  <h3 style="padding-left:10px ;">General</h3>
                                  <!--begin::Notifications-->

                                  <div *ngFor="let pack of pack_name | filter:term" class="kt-notification conf-div"
                                    id="search_query-name-list" style="cursor:pointer;" data-skin="dark"
                                    data-toggle="kt-tooltip" data-placement="top" title="{{pack.name}}">
                                    <div class="kt-notification__item-title list-group" [ngClass]="{'active_data': selectedItem == pack.name}" (click)='getBy_packId(pack.name)' >
                                    <a data-target="{{pack.name}}" class="kt-notification__item conf-link">
                                      <!-- <div class="kt-notification__item-icon">
                               <i class="fa conf-icon {{pack.pack_icon()}}"></i>
                             </div> -->
                                      <div class="kt-notification__item-details">
                                        <div class="kt-notification__item-title">
                                          {{ pack.name }}
                                        </div>
                                      </div>
                                    </a>
                                    </div>
                                  </div>
                                  <!--End::Notifications-->
                                </div>
                              </div>
                            </div>
                          </div>
                          <!--end::Portlet-->
                        </div>
                        <!-- <div class="kt-separator"></div> -->
                        <div class="col-md-8 right-content-conf">
                          <!--begin::Portlet-->
                          <div class="right-conf kt-portlet no-mar-botom portlet-body_align__table"
                            id="{{pack_data.name}}">
                            <div class="kt-portlet__head">
                              <div class="kt-portlet__head-label">
                                <span class="kt-portlet__head-icon">
                                </span>
                                <h3 class="kt-portlet__head-title">
                                  {{pack_data.name}}
                                </h3>
                              </div>
                            </div>
                            <div  *AppHasRole="role.adminAccess"  class="kt-portlet__body" style="padding:10px;">
                              <tag-input [theme]="'foundation-theme'" [placeholder]="'Add tags here...'"
                                [(ngModel)]='pack_data.tags' (onAdd)="pack_addTag(pack_data.tags,pack_data.id)"
                                (onRemove)="pack_removeTag($event,pack_data.id)" [modelAsStrings]="true"></tag-input>
                            </div>
                            <div  *AppHasRole="role.userAccess"  class="kt-portlet__body" style="padding:10px;">
                               {{pack_data.tags}}
                            </div>
                            <div class="kt-portlet__body"
                              style="height: 528px; overflow-x:scroll; padding:1.25rem; margin-bottom:20px;">
                              <div class="accordion accordion-solid" id="accordion-{{pack_data.id}}">
                                <!--begin::Portlet-->
                                <div *ngFor="let queries of pack_data?.queries | keyvalue" 
                                  style="padding: 0px;">

                                  <!--begin::Accordion-->
                                  <div class="card right-conf-card" style="margin-bottom: 0.3rem;">
                                    <div class="collapsed bg-clr style-accordion-background" data-toggle="collapse"
                                      data-skin="dark" attr.data-target="#{{pack_data.name}}-query-{{queries.value.id}}"
                                      data-placement="top" title="{{queries.value.name}}">
                                      {{ queries.value.name }}
                                      <a *AppHasRole="role.adminAccess" [routerLink]="['/hostconfiguration/packs/','query',queries.value.id,'edit']"
                                        class="query_edit" data-skin="dark" data-toggle="kt-tooltip"
                                        data-placement="top" title="Edit Query">
                                        <img class="pull-right" src="./assets/media/icons/edit-document.svg" height="24"
                                          width="24" alt="">
                                      </a>
                                    </div>
                                    <div id="{{pack_data.name}}-query-{{queries.value.id}}" class="collapse"
                                      attr.data-parent="#accordion-{{pack_data.id}}">
                                      <div class="card-body">
                                        <table class="table table-striped- table-bordered table-hover table-checkable">
                                          <tbody>
                                            <tr>
                                              <td class="head-table">Query</td>
                                              <td class="conf-table-val">
                                                <div>
                                                  <div class="sql hljs">
                                                    <span
                                                      class="hljs-keyword desc-background_packs">{{queries.value.query}}</span>
                                                  </div>
                                                </div>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table" style="width:125px">Interval <span class="intrvl-fnt-md">(in secs)</span></td>
                                              <td class="conf-table-val">
                                                <div class="desc-background_packs">{{queries.value.interval}}</div>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Platform</td>
                                              <td class="conf-table-val">
                                                <div class="desc-background_packs">{{queries.value.platform}}
                                                  <span class="col-md-1"></span>
                                                  <button  (click)="runAdHoc(queries.value.id)" class="btn-small"> Run
                                                    Live </button>
                                                </div>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Description</td>
                                              <td class="conf-table-val">
                                                <div class="desc-background_packs truncate_packs">
                                                  {{queries.value.description}}</div>
                                              </td>
                                            </tr>
                                            <!-- {% if query.version %} -->
                                            <tr>
                                              <td class="head-table">Version</td>
                                              <td>{{queries.value.version}}</td>
                                            </tr>
                                            <!-- {% endif %}
      {% if query.value %} -->
                                            <tr>
                                              <td class="head-table">Value</td>
                                              <!-- <td>{{queries.value.value}}</td> -->
                                            </tr>
                                            <!-- {% endif %} -->
                                            <tr>
                                              <td class="head-table">Packs</td>
                                              <td>
                                                {{queries.value.packs}}
                                                <span class="label">
                                                  <!-- <a ng-href="['./packs']#{{ pack.name }}">{{ pack.name }}</a> -->
                                                </span>
                                                <!-- {% endfor %} -->
                                              </td>
                                            </tr>
                                            <!-- {% if not hide_query_tags %} -->
                                            <tr *AppHasRole="role.adminAccess">
                                              <td class="head-table">Tags</td>
                                              <td>
                                                <tag-input [theme]="'foundation-theme'"
                                                  [placeholder]="'Add tags here...'" [(ngModel)]='queries.value.tags'
                                                  (onAdd)="queries_addTag(queries.value.tags,queries.value.id)"
                                                  (onRemove)="queries_removeTag($event,queries.value.id)"
                                                  [modelAsStrings]="true"></tag-input>

                                              </td>
                                            </tr>
                                            <tr *AppHasRole="role.userAccess">
                                              <td class="head-table">Tags</td>
                                              <td>
                                                {{queries.value.tags}}

                                              </td>
                                            </tr>
                                            <!-- {% endif %} -->
                                          </tbody>
                                        </table>
                                      </div>
                                    </div>
                                  </div>
                                  <!--end::Accordion-->
                                </div>
                                <!--end::Portlet-->
                              </div>
                            </div>
                          </div>
                          <!--end::Portlet-->
                        </div>
                      </div>
                      <!--end:: Content/Packs -->
                      <p *ngIf="packs_count == 0" class="txt-clr">No packs currently associated with this host. Use the
                        tag functionality to associate nodes with packs.</p>
                    </div>
                  </div>
                  <!--End:: Packs -->

                  <!--Begin:: Query -->
                  <div class="kt-portlet">
                    <div class="kt-portlet__body">
                      <h2 style="color:#616C9A">Associated Queries</h2>
                      <!--Begin:: Content/Packs -->
                      <div *ngIf="query_count != 0" class="row">
                        <div class="col-md-4">
                          <!--begin::Portlet-->
                          <div class="kt-portlet no-mar-botom portlet-body_align">
                            <div class="kt-portlet__body" style="padding: 0px;">
                              <!--begin: Search Table -->
                              <div class="">
                                <div class="kt-input-icon kt-input-icon--left" style="margin-bottom: 10px;">
                                  <!-- <input class="form-control" type="text" name="search" [(ngModel)]="searchText" autocomplete="off" placeholder="Search Packs here..." id="search_pack_query_name"> -->
                                  <input type="text" class="form-control" placeholder="Search Queries here..."
                                    id="search_pack_query_name" [(ngModel)]="termQueries">
                                  <span class="kt-input-icon__icon kt-input-icon__icon--left">
                                    <span><i class="la la-search"></i></span>
                                  </span>
                                </div>
                              </div>
                              <!--end: Search Table -->
                              <div class="" style="height: 528px; overflow-x: scroll;margin-bottom:25px;">
                                <div class="">
                                  <!--begin::Notifications-->
                                  <div *ngFor="let query of query_names |filter:termQueries " class="kt-notification conf-div"
                                    id="search_query-name-list" style="cursor:pointer;" data-skin="dark"
                                    data-toggle="kt-tooltip" data-placement="top" title="{{query.name}}">
                                    <div class="kt-notification__item-title list-group" [ngClass]="{'active_data': queryid == query.id}" (click)='getById(query.id)' >
                                    <a data-target="{{query.id}}" class="kt-notification__item conf-link">
                                      <div class="kt-notification__item-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg"
                                          xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px"
                                          viewBox="0 0 24 24" version="1.1" class="kt-svg-icon">
                                          <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                            <rect id="bound" x="0" y="0" width="24" height="24" />
                                            <path
                                              d="M10.5,5 L20.5,5 C21.3284271,5 22,5.67157288 22,6.5 L22,9.5 C22,10.3284271 21.3284271,11 20.5,11 L10.5,11 C9.67157288,11 9,10.3284271 9,9.5 L9,6.5 C9,5.67157288 9.67157288,5 10.5,5 Z M10.5,13 L20.5,13 C21.3284271,13 22,13.6715729 22,14.5 L22,17.5 C22,18.3284271 21.3284271,19 20.5,19 L10.5,19 C9.67157288,19 9,18.3284271 9,17.5 L9,14.5 C9,13.6715729 9.67157288,13 10.5,13 Z"
                                              id="Combined-Shape" fill="#000000" />
                                            <rect id="Rectangle-7-Copy-2" fill="#000000" opacity="0.3" x="2" y="5"
                                              width="5" height="14" rx="1" />
                                          </g>
                                        </svg>
                                      </div>
                                      <div class="kt-notification__item-details">
                                        <div class="kt-notification__item-title" >
                                          {{ query.name }}
                                        </div>
                                      </div>
                                    </a>
                                    </div>
                                  </div>
                                  <!--End::Notifications-->
                                </div>
                              </div>
                            </div>
                          </div>
                          <!--end::Portlet-->
                        </div>
                        <!-- <div class="kt-separator"></div> -->
                        <div class="col-md-8 right-content-conf">
                          <!--begin::Portlet-->
                          <div class="right-conf kt-portlet no-mar-botom portlet-body_align__table"
                            id="{{querydata.id}}">
                            <div class="kt-portlet__head">
                              <div class="kt-portlet__head-label">
                                <span class="kt-portlet__head-icon">
                                  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                    width="24px" height="24px" viewBox="0 0 24 24" version="1.1" class="kt-svg-icon">
                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                      <rect id="bound" x="0" y="0" width="24" height="24" />
                                      <path
                                        d="M10.5,5 L20.5,5 C21.3284271,5 22,5.67157288 22,6.5 L22,9.5 C22,10.3284271 21.3284271,11 20.5,11 L10.5,11 C9.67157288,11 9,10.3284271 9,9.5 L9,6.5 C9,5.67157288 9.67157288,5 10.5,5 Z M10.5,13 L20.5,13 C21.3284271,13 22,13.6715729 22,14.5 L22,17.5 C22,18.3284271 21.3284271,19 20.5,19 L10.5,19 C9.67157288,19 9,18.3284271 9,17.5 L9,14.5 C9,13.6715729 9.67157288,13 10.5,13 Z"
                                        id="Combined-Shape" fill="#000000" />
                                      <rect id="Rectangle-7-Copy-2" fill="#000000" opacity="0.3" x="2" y="5" width="5"
                                        height="14" rx="1" />
                                    </g>
                                  </svg>
                                </span>
                                <h3 class="kt-portlet__head-title">
                                  {{querydata.name}}
                                </h3>
                              </div>
                              <div  *AppHasRole="role.userAccess" class="kt-portlet__head-actions">
                                <a [routerLink]="['/hostconfiguration/queries/',queryid,'edit']"
                                  class="btn btn-clean btn-sm btn-icon btn-icon-md" data-skin="dark"
                                  data-toggle="kt-tooltip" data-placement="top" title="Edit Query">
                                  <i class="far fa-edit"></i>
                                </a>
                              </div>
                            </div>
                            <div class="kt-portlet__body"
                              style="height: 528px; overflow-x:scroll; padding:1.25rem; margin-bottom:20px;">
                              <div class="accordion accordion-solid" id="accordion-{{querydata.id}}">
                                <!--begin::Portlet-->
                                <div class="kt-portlet__body" style="padding: 0px;">
                                  <!--begin::Accordion-->
                                  <div class="card right-conf-card" style="margin-bottom: 0.3rem;">
                                    <div id="{{querydata.name}}-query-{{querydata.id}}">
                                      <div class="card-body">
                                        <table class="table table-striped- table-bordered table-hover table-checkable">
                                          <tbody>
                                            <tr>
                                              <td class="head-table">Query</td>
                                              <td class="conf-table-val">
                                                <div>
                                                  <div class="sql hljs">
                                                    <span
                                                      class="hljs-keyword desc-background_packs">{{querydata.query}}</span>
                                                  </div>
                                                </div>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table" style="width:125px">Interval <span class="intrvl-fnt-md">(in secs)</span></td>
                                              <td class="conf-table-val">
                                                <div class="desc-background_packs">{{querydata.interval}}</div>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Platform</td>
                                              <td class="conf-table-val">
                                                <div class="desc-background_packs">{{querydata.platform}}
                                                  <span class="col-md-1"></span>
                                                  <!-- <button  (click)="runAdHoc(querydata.id)" class="btn-success"> Run Live -->
                                                  <appbutton (click)="runAdHoc(querydata.id)" text="Run Live"  btnClass="btn-small" btnType="button"></appbutton>
                                                  <!-- </button> -->
                                                </div>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Description</td>
                                              <td class="conf-table-val">
                                                <div class="desc-background_packs truncate_packs">
                                                  {{querydata.description}}</div>
                                              </td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Version</td>
                                              <td>{{querydata.version}}</td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Value</td>
                                              <td>{{querydata.value}}</td>
                                            </tr>
                                            <tr>
                                              <td class="head-table">Packs</td>
                                              <td>
                                                {{querydata.packs}}
                                                <span class="label">
                                                  <!-- <a ng-href="['./packs']#{{ pack.name }}">{{ pack.name }}</a> -->
                                                </span>
                                              </td>
                                            </tr>
                                            <tr >
                                              <td class="head-table">Tags</td>
                                              <td *AppHasRole="role.adminAccess" >
                                                <tag-input [theme]="'foundation-theme'"  [placeholder]="'Add tags here...'" [(ngModel)]='querydata.tags'
                                                  (onAdd)="queries_addTag(querydata.tags,querydata.id)"
                                                  (onRemove)="queries_removeTag($event,querydata.id)"
                                                  [modelAsStrings]="true"></tag-input>
                                              </td>
                                              <td *AppHasRole="role.userAccess">
                                                {{querydata?.tags}}
                                              </td>
                                            </tr>
                                            <!-- {% endif %} -->
                                          </tbody>
                                        </table>
                                      </div>
                                    </div>

                                  </div>
                                  <!--end::Accordion-->
                                </div>
                                <!--end::Portlet-->
                              </div>
                            </div>
                          </div>
                          <!--end::Portlet-->
                        </div>
                      </div>
                      <!--end:: Content/Packs -->
                      <p *ngIf="query_count == 0" class="txt-clr">No queries currently associated with this host. Use
                        the tag functionality to associate nodes with queries.</p>
                    </div>
                  </div>
                  <!--End:: Query -->
                 </div>


                 <!-- RECENT ACTIVITY -->
                <div class="tab-pane" id="recent_activity" role="tabpanel">
                  <div class="kt-portlet__body no-padding">
                    <!--Begin:: Content -->
                    <!-- {% if queries_packs  %} -->
                    <div id="activity_node">
                      <!--begin::System Data-->
                    <div *ngIf = "activitynode?.length != 0" class="kt-portlet kt-portlet--responsive-mobile" style="margin-bottom: 0px;">
                    <div class="kt-portlet__body no-padding">
                    <div class="row">
                      <div class="col-lg-2 col-md-3 nav-background col-queryborder">
                        <!--begin: Search Table -->
                        <div class="">
                          <div class="kt-input-icon kt-input-icon--left" style="margin-bottom: 10px;">
                            <input type="text" class="form-control" placeholder="Search here..." id="search_rule_name" [(ngModel)]="activitysearch">
                            <span class="kt-input-icon__icon kt-input-icon__icon--left">
                              <span><i class="la la-search"></i></span>
                            </span>
                          </div>
                        </div>
                        <!--end: Search Table -->
                        <div class="col-queryname nav-tab_align ">
                          <div class="" >
                                <div *ngFor="let activeNodes of ( activitynode | activitysearch:activitysearch ) as result " class="kt-notification conf-div " id="rule" style="cursor:pointer;" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="{{activeNodes.name}}">
                                  <div *ngIf="activeNodes === -1">No Matching Record Found</div>
                                  <div *ngIf="activeNodes != -1">
                
                
                              <div class="kt-notification__item-title recent-activity-tab list-group "  [ngClass]="{'active': selectedItem == activeNodes.name}"   (click)='getByActivityId($event, activeNodes.name,activeNodes.name, this.id)'>
                              <a data-target="{{activeNodes.name}}" class="" >
                                <div class="kt-notification__item-title nav_border">
                                      <!-- Application Shim Installation -->
                                    <span class="badge-queryname">{{activeNodes.name}}</span>
                                      &nbsp;
                                    <span class="kt-badge kt-badge--primary kt-badge--inline kt-badge--pill badge-queryname" >{{activeNodes.count}}</span>
                                </div>
                              </a>
                              </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                
                      <div class="col-lg-10 col-md-9 col-querytable">
                        <div class="tab-content" >
                          <div *ngIf="this.queryname == 'windows_events' || this.queryname == 'windows_real_time_events'" class="pull-right" style="padding-bottom: 5px;">
                          <angular2-multiselect [data]="Events_dropdownList" [(ngModel)]="Events_selectedItems"
                          [settings]="Events_dropdownSettings"
                          (onSelect)="onItemSelect($event)"
                          (onDeSelect)="OnItemDeSelect($event)"
                          (onSelectAll)="onSelectAll($event)"
                          (onDeSelectAll)="onDeSelectAll($event)"
                          class="recent-activity-c-btn"></angular2-multiselect>
                        </div>
                          <table datatable [dtOptions]="ActivitydtOptions" [dtTrigger]="ActivitydtTrigger" class="table table-hover table-checkable">
                            <h4 class="recentActivityLoader" style="margin-left: 3%;margin-top:2%;"> Loading Data...<span class=" spinner-border" role="status" style="color: #3498db;" aria-hidden="true"></span></h4>
                            <thead>
                                <tr role="row">
                                  <th class="sorting_disabled details-control" rowspan="1" colspan="1" style="color: #595d6e;font-weight: 500;font-size:15px;">{{selectedItem}} data</th>
                                </tr>
                            </thead>
                            <tbody>
                
                              <tr *ngFor="let hostdata of this.activitydatanode " style="font-size: 13px; font-family:Roboto; font-weight: 600;">
                                  <td class="cell-breakWord">
                                    <div (click)="ele.class = ele.class == 'showChildren' ? '' : 'showChildren'" [ngClass]="{ hideChildren : ele.class !== 'showChildren' }" #ele>
                                      <font color='#16ace3'>
                                    {{myjson.stringify(hostdata.columns)}}
                                  </font>
                                    <div (click)="action($event);false" >
                                      <div class="col-10"></div>
                                      <th >
                                    <dt *ngFor="let subhostdata of hostdata.columns | keyvalue">
                                    <dl *ngIf="subhostdata.key=='process_guid' || subhostdata.key=='parent_process_guid'" style="word-break: break-word;padding-left: 40px;" >
                
                                    {{subhostdata.key}}
                                    {{":"}}
                
                                    <a *ngIf="this.queryname != 'win_image_load_events'" (click)="process_guid_graph(hostdata,subhostdata.value)" data-toggle="modal" href="#processTree">{{subhostdata.value}}</a>
                                    <a *ngIf="this.queryname == 'win_image_load_events'" >{{subhostdata.value}}</a>
                                    </dl>
                
                                    <!--URL-->
                                    <dl *ngIf="subhostdata.key=='url'" style="word-break: break-word;padding-left: 40px;" >
                
                                    {{subhostdata.key}}
                                    {{":"}}
                
                                    <a onclick="window.open(this.href,'_blank');return false;" target="_blank" href="https://www.virustotal.com/gui/domain/{{subhostdata.value}}/detection" >{{subhostdata.value}}</a>
                                    </dl>
                
                                    <!--md5-->
                                    <dl *ngIf="subhostdata.key=='md5'" style="word-break: break-word;padding-left: 40px;" >
                
                                    {{subhostdata.key}}
                                    {{":"}}
                
                                    <a onclick="window.open(this.href,'_blank');return false;" target="_blank"  href="https://www.virustotal.com/#/file/{{subhostdata.value}}/detection" >{{subhostdata.value}}</a>
                                    </dl>
                
                                    <!--domain_name-->
                                    <dl *ngIf="subhostdata.key=='domain_name'" style="word-break: break-word;padding-left: 40px;" >
                
                                    {{subhostdata.key}}
                                    {{":"}}
                
                                    <a onclick="window.open(this.href,'_blank');return false;" href="https://www.virustotal.com/#/domain/{{subhostdata.value}}" >{{subhostdata.value}}</a>
                                    </dl>
                
                                    <!--sha1-->
                                    <dl *ngIf="subhostdata.key=='sha1'" style="word-break: break-word;padding-left: 40px;" >
                
                                    {{subhostdata.key}}
                                    {{":"}}
                
                                    <a onclick="window.open(this.href,'_blank');return false;" href="https://www.virustotal.com/#/file/{{subhostdata.value}}/detection" >{{subhostdata.value}}</a>
                                    </dl>
                
                                    <!--sha256-->
                                    <dl *ngIf="subhostdata.key=='sha256'" style="word-break: break-word;padding-left: 40px;" >
                
                                    {{subhostdata.key}}
                                    {{":"}}
                
                                    <a onclick="window.open(this.href,'_blank');return false;" href="https://www.virustotal.com/#/file/{{subhostdata.value}}/detection" >{{subhostdata.value}}</a>
                                    </dl>
                
                                      <dl *ngIf="!(subhostdata.key=='process_guid' || subhostdata.key=='parent_process_guid') && !(subhostdata.key=='url') && !(subhostdata.key=='md5') && !(subhostdata.key=='domain_name') && !(subhostdata.key=='sha1') && !(subhostdata.key=='sha256')" style="word-break: break-word;padding-left: 40px;" >
                
                                        {{subhostdata.key}}
                                        {{":"}}
                
                                      {{subhostdata.value}}
                                      </dl>
                                    </dt>
                                  </th>
                                    </div>
                
                
                
                                    </div>
                
                                    <div >
                                      <!-- Modal -->
                                      <div class="modal fade" id="processTree" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" style="">
                                        <div class="modal-dialog modal-lg" role="document">
                                          <div class="modal-content">
                                            <div class="modal-header">
                                              <h3 class="kt-portlet__head-title" style="font-size: 15px">
                                                Process Analysis Tree
                                              </h3>
                                              <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="close_data()" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="Close"></button>
                                            </div>
                                            <!-- <div class="modal-body"> -->
                                              <!--begin:: Widgets/Tasks -->
                                              <div class="modal-body">
                                                <!-- <p>test</p> -->
                                                <div class="card-body">
                                                  <div class="row">
                                                    <div class="col-md-8">
                                                      <div  id="d3-graph-2" style="overflow: auto"></div>
                                                    </div>
                                                    <div class="col-md-4" style="padding: 0px;">
                                                      <div style="text-align: center; margin-top: 6px;">
                                                        <!-- <i class="drawline2" style="left: 20px;"></i> -->
                                                        <i class="fa fa-info-circle nodeinfo"> Event info</i>
                                                        <!-- <i class="drawline2" style="right: 20px;"></i> -->
                                                      </div>
                                                      <table id="pf-timeline-data" class="display" style="margin-top: 3px !important">
                                                        <thead>
                                                        <tr style="text-align: center;">
                                                          <th></th>
                                                        </tr>
                                                        </thead>
                                                        <div  class="" id="accordion2" style="">
                                                          <tbody id="eventsData_process"></tbody>
                                                        </div>
                                                      </table>
                                                    </div>
                                                  </div>
                                                </div>
                                              </div>
                
                                              <!--end:: Widgets/Tasks -->
                                            <!-- </div> -->
                                            <div class="modal-footer">
                                              <button type="button" class="btn btn-small-opaque" (click)="close_data()" data-dismiss="modal">Close</button>
                
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                    <!-- <mat-expansion-panel>
                                    <mat-expansion-panel-header>
                                    <mat-panel-description>
                                    <div class='' ><font color='#16ace3'> {{myjson.stringify(hostdata.columns)}} </font></div>
                                    </mat-panel-description>
                                    </mat-expansion-panel-header>
                                    <dt *ngFor="let subhostdata of hostdata.columns.replace('{', '').replace('}', '').split(',').sort()">
                                    <dl>
                
                                    {{subhostdata}}
                                    </dl>
                
                                    </dt>
                                    </mat-expansion-panel> -->
                                    </td>
                                </tr>
                            </tbody>
                            <div *ngIf="this.activitydatanode === null ">
                              <span style=" text-align: center; padding-left: 300px;font-size: larger;font-weight: 600;">
                              {{errorMessage}}
                            </span>
                            </div>
                          </table>
                
                
                
                        </div>
                      </div>
                    </div>
                    </div>
                    </div>
                
                    <div id="container" style="display:none;"></div>
                
                    </div>
                    <!-- {% else %} -->
                    <!-- <p *ngIf = "activitynode.length == 0">No recent activity for this host.</p> -->
                        <!-- {% endif %} -->
                    <!--Begin:: Content -->
                    <div *ngIf="activitynode?.length == 0">
                      <p style="color: #646c9a;font-size: 13px;font-weight: 400;">No recent activity for this host</p>
                    </div>
                </div>
                </div>
                <!--end:: Additional/packs/query/tags -->

              </div>
            </div>






          </div>
          <!-- end:: Portlet/tab -->



        </div>
      </div>
    </div>
  </div>
</div>

